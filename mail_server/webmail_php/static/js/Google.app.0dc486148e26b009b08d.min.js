"use strict";(self.webpackChunkafterlogic_aurora_platform=self.webpackChunkafterlogic_aurora_platform||[]).push([[914],{"150G":(e,t,o)=>{var n=o("a7T2"),c=o("p09A"),s=o("KC/L");e.exports={ServerModuleName:"Google",HashModuleName:"google",Connected:!1,EnableModule:!1,Id:"",Secret:"",Key:"",Scopes:[],init:function(e){var t=n.extend({},e[this.ServerModuleName]||{},e.Google||{});n.isEmpty(t)||(this.Connected=s.pBool(t.Connected,this.Connected),this.EnableModule=s.pBool(t.EnableModule,this.EnableModule),this.Id=s.pString(t.Id,this.Id),this.Secret=s.pString(t.Secret,this.Secret),this.Key=s.pString(t.Key,this.Key),this.Scopes=s.pArray(t.Scopes,this.Scopes))},getScopesCopy:function(){var e=[];return n.each(this.Scopes,(function(t){e.push({Description:t.Description,Name:t.Name,Value:c.observable(t.Value)})})),e},updateScopes:function(e,t){var o=[];n.each(t,(function(e){o.push({Description:e.Description,Name:e.Name,Value:e.Value()})})),this.Connected=e,this.Scopes=o},updateAdmin:function(e,t,o,n,c){this.EnableModule=e,this.Id=t,this.Secret=o,this.Key=n,this.Scopes=c}}},t6Yg:(e,t,o)=>{e.exports=function(e){var t=o("a7T2"),n=o("H20a"),c=o("9kOp"),s=o("150G");return s.init(e),c.isUserNormalOrTenant()&&s.EnableModule&&t.isArray(s.Scopes)&&s.Scopes.length>0?{start:function(e){e.run("SettingsWebclient","registerSettingsTab",[function(){return o("nAbd")},s.HashModuleName,n.i18n("GOOGLE/LABEL_SETTINGS_TAB")])}}:null}},nAbd:(e,t,o)=>{var n=o("a7T2"),c=o("M4cL"),s=o("p09A"),i=o("KC/L"),a=o("Tt1R"),r=o("EFhx"),u=o("/QeJ"),l=o("9kOp"),p=o("TdEd"),h=o("mGms"),d=p.run("SettingsWebclient","getAbstractSettingsFormViewClass"),S=o("150G");function g(){d.call(this,S.ServerModuleName),this.connected=s.observable(S.Connected),this.scopes=s.observable(S.getScopesCopy()),this.bRunCallback=!1,window.googleConnectCallback=n.bind((function(e,t,o){this.bRunCallback=!0,e?(this.connected(!0),this.updateSavedState(),S.updateScopes(this.connected(),this.scopes())):u.showErrorByCode({ErrorCode:i.pInt(t),Module:o},"",!0)}),this)}n.extendOwn(g.prototype,d.prototype),g.prototype.ViewTemplate="Google_GoogleSettingsFormView",g.prototype.getCurrentValues=function(){var e=n.map(this.scopes(),(function(e){return e.Name+e.Value()}));return[this.connected(),e]},g.prototype.revertGlobalValues=function(){this.connected(S.Connected),this.scopes(S.getScopesCopy())},g.prototype.checkAndConnect=function(){var e={Scopes:[],Service:"google",AllowConnect:!0},t=n.find(this.scopes(),(function(e){return"auth"===e.Name})),o=!!t&&!!t.Value(),c=n.find(S.getScopesCopy(),(function(e){return"auth"===e.Name})),s=!!c&&!!c.Value();n.each(this.scopes(),(function(t){t.Value()&&e.Scopes.push(t.Name)})),l.broadcastEvent("OAuthAccountChange::before",e),e.AllowConnect&&(o||o===s||!o&&l.isAccountDeletingAvailable())&&this.connect(e.Scopes)},g.prototype.connect=function(e){c.removeCookie("oauth-scopes"),c.cookie("oauth-scopes",e.join("|")),c.cookie("oauth-redirect","connect"),this.bRunCallback=!1;var t=h.open(a.getAppPath()+"?oauth=google-connect","Google"),o=setInterval(n.bind((function(){t.closed&&(clearInterval(o),this.bRunCallback?(l.broadcastEvent("OAuthAccountChange::after"),this.updateSavedState(),S.updateScopes(this.connected(),this.scopes())):window.location.reload())}),this),1e3)},g.prototype.checkAndDisconnect=function(){var e={Service:"google",AllowDisconnect:!0},t=n.find(S.getScopesCopy(),(function(e){return"auth"===e.Name})),o=!!t&&!!t.Value();l.broadcastEvent("OAuthAccountChange::before",e),!e.AllowDisconnect||o&&!l.isAccountDeletingAvailable()||this.disconnect()},g.prototype.disconnect=function(){r.send(S.ServerModuleName,"DeleteAccount",null,(function(e){e.Result?(this.connected(!1),n.each(this.scopes(),(function(e){e.Value(!1)})),l.broadcastEvent("OAuthAccountChange::after"),this.updateSavedState(),S.updateScopes(this.connected(),this.scopes())):u.showErrorByCode(e,"",!0)}),this)},e.exports=new g}}]);