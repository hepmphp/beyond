(self.webpackChunkafterlogic_aurora_platform=self.webpackChunkafterlogic_aurora_platform||[]).push([[381],{A3in:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("sdEb"),r={getTimeListStepHour:function(e,t){return e=e||"HH:mm",t=t||"k",i.map(["00:00","01:00","02:00","03:00","04:00","05:00","06:00","07:00","08:00","09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00","19:00","20:00","21:00","22:00","23:00"],(function(s){var i=o(s,"HH:mm");return{text:i.format(e),value:i.format(t)}}))},getTimeListStepHalfHour:function(e){return i.map(["00:00","00:30","01:00","01:30","02:00","02:30","03:00","03:30","04:00","04:30","05:00","05:30","06:00","06:30","07:00","07:30","08:00","08:30","09:00","09:30","10:00","10:30","11:00","11:30","12:00","12:30","13:00","13:30","14:00","14:30","15:00","15:30","16:00","16:30","17:00","17:30","18:00","18:30","19:00","19:30","20:00","20:30","21:00","21:30","22:00","22:30","23:00","23:30"],(function(t){var s=o(t,"HH:mm").format(e);return{text:s,value:s}}))},getDateFormatForDatePicker:function(e){return e.replace("MM","mm").replace("DD","dd").replace("YYYY","yy").replace("Month","MM")}};e.exports=r},"171C":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("skxT"),r={checkIfFieldsEmpty:function(e,t){var s=i.find(e,(function(e){return""===e()}));return!s||(t&&o.showError(t),s.focused(!0),!1)},checkPassword:function(e,t){var i=s("H20a"),r=s("OfVV"),n=!1;return t!==e?o.showError(i.i18n("COREWEBCLIENT/ERROR_PASSWORDS_DO_NOT_MATCH")):r.PasswordMinLength>0&&e.length<r.PasswordMinLength?o.showError(i.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SHORT").replace("%N%",r.PasswordMinLength)):!r.PasswordMustBeComplex||e.match(/([0-9])/)&&e.match(/([!,%,&,@,#,$,^,*,?,_,~])/)?n=!0:o.showError(i.i18n("COREWEBCLIENT/ERROR_PASSWORD_TOO_SIMPLE")),n}};e.exports=r},"T+dd":(e,t,s)=>{"use strict";var i=s("a7T2");void 0===window.Enums&&(window.Enums={}),i.extendOwn(window.Enums,{FolderFilter:{Flagged:"flagged",Unseen:"unseen"},FolderTypes:{Inbox:1,Sent:2,Drafts:3,Spam:4,Trash:5,Virus:6,Starred:7,Template:8,System:9,User:10,AllInboxes:11},SearchFoldersMode:{Current:"",Sub:"sub",All:"all"},Importance:{Low:5,Normal:3,High:1},Sensitivity:{Nothing:0,Confidential:1,Private:2,Personal:3},AnotherMessageComposedAnswer:{Discard:"Discard",SaveAsDraft:"SaveAsDraft",Cancel:"Cancel"},ReplyType:{Reply:"reply",ReplyAll:"reply-all",Resend:"resend",Forward:"forward",ForwardAsAttach:"eml"},UseSignature:{Off:"0",On:"1"},MailErrors:{CannotMoveMessageQuota:4008},ServerOwnerType:{Account:"account",Tenant:"tenant",SuperAdmin:"superadmin"},StarredMessagesSource:{InboxOnly:"inbox_only",AllFolders:"all_folders"}})},"ZVZ+":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL");s("p09A").bindingHandlers.highlighter={init:function(e,t,s,r,n){var a,l=o(e),h=t(),c=h.valueObserver?h.valueObserver:null,u=h.highlighterValueObserver?h.highlighterValueObserver:null,d=h.highlightTrigger?h.highlightTrigger:null,p=["from:","to:","subject:","text:","email:","has:","date:","text:","body:","folders:"],m=(a="",o.each(p,(function(e,t){a=e?a+"|\\b"+t:a+"\\b"+t})),new RegExp("("+a+")","g")),g=function(e){return e.replace(/\xC2\xA0/g," ").replace(/\xA0/g," ").replace(/[\s]+/g," ")},b=-1,f=window.navigator.language||window.navigator.userLanguage,S=!i.include(["zh","zh-TW","zh-CN","zh-HK","zh-SG","zh-MO","ja","ja-JP","ko","ko-KR","vi","vi-VN","th","th-TH"],f);function E(t){if(S){var s=0,r=l.text().split(m),n=[];i.each(r,(function(e){var t=e.split("");i.any(p,(function(t){return t===e}))?i.each(t,(function(e){n.push(o(e.replace(/(.)/,'<span class="search_highlight">$&</span>')))})):i.each(t,(function(e){" "===e?n.push(document.createTextNode(" ")):n.push(document.createTextNode(e))}))})),l.is(":focus")?(s=function(e){var t=null,s={},i={},r=0;return window.getSelection&&document.createRange?(t=window.getSelection()).rangeCount>0&&((i=(s=t.getRangeAt(0)).cloneRange()).selectNodeContents(e),i.setEnd(s.startContainer,s.startOffset),r=i.toString().length,o(e).html().length<r&&(r=0)):document.selection&&document.body.createTextRange&&(s=document.selection.createRange(),(i=document.body.createTextRange()).moveToElementText(e),"function"==typeof i.setEndPoint&&i.setEndPoint("EndToStart",s),r=i.text.length),r}(e),l.empty().append(n),function(e,t){var s,i,o;if(!e)return!1;if(document.createRange)(s=document.createRange()).selectNodeContents(e),s.setStart(e,t),s.setEnd(e,t),(i=window.getSelection()).removeAllRanges(),i.addRange(s);else{if(e.createTextRange)return(o=e.createTextRange()).collapse(!0),o.moveEnd(t),o.moveStart(t),o.select(),!0;if(e.setSelectionRange)e.setSelectionRange(t,t)}}(e,s)):l.empty().append(n)}}o(e).on("keydown",(function(e){return e.keyCode!==Enums.Key.Enter})).on("keyup",(function(e){var t=[Enums.Key.Left,Enums.Key.Right,Enums.Key.Home,Enums.Key.End],s=-1!==o.inArray(e.keyCode,t);return e.keyCode===Enums.Key.Shift||e.keyCode===Enums.Key.Alt||e.keyCode===Enums.Key.Ctrl||e.keyCode===Enums.Key.Dash||e.keyCode===Enums.Key.Apostrophe||e.keyCode===Enums.Key.Six&&e.shiftKey||s||(e.ctrlKey||b===Enums.Key.Ctrl)&&e.keyCode===Enums.Key.a||(c(g(l.text())),E()),b=e.keyCode,!0})).on("paste",(function(e){if(document.queryCommandSupported("insertText")){e.preventDefault();var t="";e.clipboardData||e.originalEvent.clipboardData?t=(e.originalEvent||e).clipboardData.getData("text/plain"):window.clipboardData&&(t=window.clipboardData.getData("Text")),document.execCommand("insertText",!1,t)}setTimeout((function(){c(g(l.text())),E()}),0)})),setTimeout((function(){E()}),0),d.notifySubscribers(),d.subscribe((function(e){setTimeout((function(){E()}),0)}),this),u.subscribe((function(){var e=l.text(),t=c();e.replace(" "," ")!==t.replace(" "," ")&&l.text(t)}),this)}}},UJpV:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("TdEd").run("MailWebclient","getComposeMessageToAddresses");i.isFunction(n)&&(r.bindingHandlers.makeLinkComposeMailTo={update:function(e,t,s,i,r){var a=o(e),l=t();a.show(),a.hasClass("button")||a.addClass("link"),a.click((function(){n(l)}))}}),r.bindingHandlers.moveToFolderFilter={init:function(e,t,s,r,n){var a=o(e),l=t(),h=o(e).find(l.container),c=i.isArray(l.options)?l.options:l.options(),u=l.value?l.value():"";i.find(c,(function(e){return e[l.optionsValue]===u}))||(u="",l.value("")),a.removeClass("expand"),h.empty(),i.each(c,(function(e){var t=o('<span class="item"></span>').text(e[l.optionsText]).data("value",e[l.optionsValue]);u===e[l.optionsValue]&&t.addClass("selected"),e.jq=t,h.append(t)})),h.on("click",".item",(function(){var e=o(this).data("value");l.value(e)})),a.click((function(){a.toggleClass("expand"),a.hasClass("expand")&&i.defer((function(){o(document).one("click",(function(){a.removeClass("expand")}))}))}))},update:function(e,t){var s=o(e),r=t(),n=i.isArray(r.options)?r.options:r.options(),a=r.value?r.value():"",l=i.find(n,(function(e){return e[r.optionsValue]===a})),h=s.find(".link");i.each(n,(function(e){e.jq&&e.jq.toggleClass("selected",a===e[r.optionsValue])})),l&&h.text(o.trim(l[r.optionsText]))}}},"+Dc/":(e,t,s)=>{"use strict";e.exports=function(e){s("T+dd");var t=s("a7T2"),i=s("p09A"),o=s("9kOp"),r=s("TdEd"),n=s("oFXy"),a=null,l=null,h=null;if(n.init(e),!r.isModuleAvailable(n.ServerModuleName))return null;if(a=s("7xgn"),o.isUserNormalOrTenant()){var c=s("F0Fd");if(c.init(),o.isNewTab()){var u=function(){if(null===l){var e=s("aB/g");l=new e}return l};return{start:function(){s("UJpV")},getScreens:function(){var e={};return e[n.HashModuleName+"-view"]=function(){return s("kb14")},e[n.HashModuleName+"-compose"]=function(){return u()},e},registerComposeToolbarController:function(e){u().registerToolbarController(e)},registerComposeMessageRowController:function(e){u().registerMessageRowController(e)},registerComposeUploadAttachmentsController:function(e){u().registerUploadAttachmentsController(e)},getComposeMessageWithData:function(){return s("B5X4").composeMessageWithData},getComposeMessageToAddresses:function(){return s("B5X4").composeMessageToAddresses},getComposeMessageWithAttachments:function(){return s("B5X4").composeMessageWithAttachments},getSearchMessagesInCurrentFolder:function(){var e=window.opener&&window.opener.MainTabMailMethods;return!!e&&t.bind(e.searchMessagesInCurrentFolder,e)},getCurrentMessage:function(){return c.currentMessage()},getCurrentFolderList:function(){return c.folderList()},syncFolders:function(){return c.getFolderList(c.currentAccountId())},removeMessageFromCurrentList:function(e,t,s){return c.removeMessageFromCurrentList(e,t,s)}}}var d={enableModule:i.observable(n.AllowAddAccounts||a.hasAccount()),getComposeMessageToAddresses:function(){return s("B5X4").composeMessageToAddresses},getComposeMessageWithData:function(){return s("B5X4").composeMessageWithData},getComposeMessageWithAttachments:function(){return s("B5X4").composeMessageWithAttachments},getPrefetcher:function(){return s("uC+w")},registerComposeToolbarController:function(e){s("/N4H").registerToolbarController(e)},registerComposeMessageRowController:function(e){s("/N4H").registerMessageRowController(e)},registerComposeUploadAttachmentsController:function(e){s("/N4H").registerUploadAttachmentsController(e)},getSearchMessagesInInbox:function(){return t.bind(c.searchMessagesInInbox,c)},getFolderHash:function(e){return c.getFolderHash(e)},getSearchMessagesInCurrentFolder:function(){return t.bind(c.searchMessagesInCurrentFolder,c)},getMessage:function(e,t,s){return c.getMessage(c.currentAccountId(),e,t,s,c)},getCurrentMessage:function(){return c.currentMessage()},getCurrentFolderList:function(){return c.folderList()},syncFolders:function(){return c.getFolderList(c.currentAccountId())},removeMessageFromCurrentList:function(e,t,s){return c.removeMessageFromCurrentList(e,t,s)},deleteMessages:function(e,t,s){var i=c.getFolderByFullName(e,t);c.deleteMessagesFromFolder(i,s)},getAllAccountsFullEmails:function(){return a.getAllFullEmails()},getAccountList:function(){return a},getMailCache:function(){return c},setCustomRouting:function(e,t,i,o,r,a){var l=s("W66n"),h=s("CPab");l.setHash(h.getMailbox(e,t,i,o,r,n.MessagesSortBy.DefaultSortBy,n.MessagesSortBy.DefaultSortOrder,a))}};return o.isMobile()||(d=t.extend(d,{start:function(e){var o=s("H20a"),r=s("dfnr"),l=s("WOsA");if(s("UJpV"),s("ZVZ+"),n.AllowAppRegisterMailto&&l.registerMailto(r.firefox),n.AllowAddAccounts||a.hasAccount()){e.run("SettingsWebclient","registerSettingsTab",[function(){return s("SpBH")},n.HashModuleName,o.i18n("MAILWEBCLIENT/LABEL_SETTINGS_TAB")]);var h=n.AllowMultiAccounts?o.i18n("MAILWEBCLIENT/LABEL_ACCOUNTS_SETTINGS_TAB"):o.i18n("MAILWEBCLIENT/LABEL_ACCOUNT_SETTINGS_TAB");e.run("SettingsWebclient","registerSettingsTab",[function(){return s("r9cz")},n.HashModuleName+"-accounts",h])}i.computed((function(){var e=t.filter(a.collection(),(function(e){return e.useToAuthorize()})),s=t.map(e,(function(e){return e.email()}));n.userMailAccountsCount(e.length),n.mailAccountsEmails(s)}),this)},getScreens:function(){var e={};return e[n.HashModuleName]=function(){return new(s("fveu"))},e},getHeaderItem:function(){if(null===h&&n.AllowOtherModulesToReplaceTabsbarHeader){let e={};o.broadcastEvent("MailWebclient::GetHeaderItemView",e),h=e.HeaderItemView||null}return null===h&&(h=s("Uzkn")),{item:h,name:n.HashModuleName}},getMobileSyncSettingsView:function(){return s("fSBA")}})),d}return null}},"9BUb":(e,t,s)=>{"use strict";var i=s("KC/L");function o(){this.iAccountId=0,this.enable=!1,this.subject="",this.message="",this.scheduled=!1,this.start=null,this.end=null}s("sdEb"),o.prototype.parse=function(e,t){this.iAccountId=e,this.enable=!!t.Enable,this.subject=i.pString(t.Subject),this.message=i.pString(t.Message),this.scheduled=!!t.Scheduled,t.Start&&(this.start=i.pInt(t.Start)),t.End&&(this.end=i.pInt(t.End))},e.exports=o},lHET:(e,t,s)=>{"use strict";var i=s("KC/L");function o(){this.iAccountId=0,this.enable=!1,this.keepcopy=!1,this.email=""}o.prototype.parse=function(e,t){this.iAccountId=e,this.enable=!!t.Enable,this.keepcopy=!!t.KeepMessageCopy,this.email=i.pString(t.Email)},e.exports=o},mJTN:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("171C"),h=s("/QeJ"),c=s("o1lX"),u=s("7xgn"),d=s("QaEg"),p=s("FSu3"),m=s("Z8ia");function g(){c.call(this),this.loading=r.observable(!1),this.friendlyName=r.observable(""),this.email=r.observable(""),this.email.focused=r.observable(!1),this.incomingLogin=r.observable(""),this.incomingLogin.focused=r.observable(!1),this.incomingPassword=r.observable(""),this.incomingPassword.focused=r.observable(!1),this.oServerPairPropertiesView=new m("acc_create"),this.email.focused.subscribe((function(){this.email.focused()||""!==o.trim(this.incomingLogin())||this.incomingLogin(this.email())}),this),this.aRequiredFields=[this.email,this.incomingLogin,this.incomingPassword].concat(this.oServerPairPropertiesView.aRequiredFields)}i.extendOwn(g.prototype,c.prototype),g.prototype.PopupTemplate="MailWebclient_Settings_CreateAccountPopup",g.prototype.init=function(){this.friendlyName(""),this.email(""),this.incomingLogin(""),this.incomingLogin.focused(!1),this.incomingPassword(""),this.oServerPairPropertiesView.fullInit()},g.prototype.onOpen=function(e,t,s,i){this.fCallback=e,this.init(),this.friendlyName(t),this.email(s),this.incomingLogin(s),this.incomingPassword(i),this.focusFieldToEdit()},g.prototype.focusFieldToEdit=function(){var e=i.find(this.aRequiredFields,(function(e){return""===e()}));e?e.focused(!0):this.aRequiredFields.length>0&&this.aRequiredFields[0].focused(!0)},g.prototype.onClose=function(){this.init()},g.prototype.save=function(){if(l.checkIfFieldsEmpty(this.aRequiredFields,n.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY"))){var e={FriendlyName:this.friendlyName(),Email:o.trim(this.email()),IncomingLogin:o.trim(this.incomingLogin()),IncomingPassword:o.trim(this.incomingPassword()),Server:this.oServerPairPropertiesView.getParametersForSave()};this.loading(!0),d.send("CreateAccount",e,this.onAccountCreateResponse,this)}else this.loading(!1)},g.prototype.onAccountCreateResponse=function(e,t){if(this.loading(!1),e.Result){var s=a.pInt(e.Result.AccountID),i=new p(e.Result);u.addAccount(i),u.populateIdentities(),u.changeEditedAccount(s),1===u.collection().length&&u.changeCurrentAccount(s),this.fCallback&&this.fCallback(s),this.closePopup()}else h.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_CREATE_ACCOUNT"))},e.exports=new g},"/nhf":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("171C"),h=s("Tt1R"),c=s("/QeJ"),u=s("o1lX"),d=s("EFhx"),p=s("oUN1"),m=s("mJTN"),g=s("TdEd"),b=s("mGms"),f=s("7xgn"),S=s("QaEg"),E=s("FSu3"),A=s("Oh7n");function v(){u.call(this),this.oauthOptions=r.observableArray([]),this.oauthOptionsVisible=r.observable(!1),this.bOAuthCallbackExecuted=!1,this.loading=r.observable(!1),this.friendlyName=r.observable(""),this.email=r.observable(""),this.email.focused=r.observable(!1),this.password=r.observable(""),this.password.focused=r.observable(!1),this.aRequiredFields=[this.email,this.password]}i.extendOwn(v.prototype,u.prototype),v.prototype.PopupTemplate="MailWebclient_Settings_CreateAccountShortFormPopup",v.prototype.init=function(){this.friendlyName(""),this.email(""),this.password("")},v.prototype.onOpen=function(e,t){this.oauthOptions(e),this.oauthOptionsVisible(this.oauthOptions().length>0),this.fCallback=t,this.init(),this.focusFieldToEdit()},v.prototype.selectAuthOption=function(e){""===e?this.oauthOptionsVisible(!1):this.getOAuthData(e)},v.prototype.focusFieldToEdit=function(){var e=i.find(this.aRequiredFields,(function(e){return""===e()}));e?e.focused(!0):this.aRequiredFields.length>0&&this.aRequiredFields[0].focused(!0)},v.prototype.onClose=function(){this.init()},v.prototype.getOAuthData=function(e){var t=o.cookie("oauth-scopes"),s=i.isUndefined(t)?[]:t.split("|");s.push("mail"),s=i.unique(s),o.removeCookie("oauth-scopes"),o.cookie("oauth-scopes",s.join("|")),this.bOAuthCallbackExecuted=!1,window.gmailConnectCallback=function(e,t,s){this.bOAuthCallbackExecuted=!0,e?d.send("OAuthIntegratorWebclient","CreateMailAccount",{OAuthAccountData:e},this.onAccountCreateResponse,this):c.showErrorByCode({ErrorCode:a.pInt(t),Module:s},"",!0)}.bind(this);var r=b.open(h.getAppPath()+"?oauth="+e+"-connect","OAuth"),n=setInterval(function(){r.closed&&(clearInterval(n),this.bOAuthCallbackExecuted||window.location.reload())}.bind(this),1e3)},v.prototype.save=function(){if(l.checkIfFieldsEmpty(this.aRequiredFields,n.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY"))){var e={Domain:o.trim(this.email()).split("@")[1],AllowWildcardDomain:!0};this.loading(!0),S.send("GetMailServerByDomain",e,this.onGetMailServerByDomain,this)}else this.loading(!1)},v.prototype.onGetMailServerByDomain=function(e,t){var s=null;if(e.Result&&void 0!==e.Result.Server&&void 0!==e.Result.FoundWithWildcard)if(e.Result.FoundWithWildcard){var r=o.trim(this.email()).split("@")[1],n=f.getDefault()?f.getDefault().email():"";r===o.trim(n).split("@")[1]&&(s=new A(e.Result.Server))}else s=new A(e.Result.Server);if(s){var a={FriendlyName:this.friendlyName(),Email:o.trim(this.email()),IncomingLogin:o.trim(this.email()),IncomingPassword:o.trim(this.password()),Server:{ServerId:s.iId}};S.send("CreateAccount",a,this.onAccountCreateResponse,this)}else this.loading(!1),p.showPopup(m,[i.bind((function(e){var t=f.getAccount(e);t&&this.editAccount(t.hash())}),this),this.friendlyName(),o.trim(this.email()),o.trim(this.password())]),this.closePopup()},v.prototype.onAccountCreateResponse=function(e,t){if(this.loading(!1),e.Result){var s=a.pInt(e.Result.AccountID),i=new E(e.Result);f.addAccount(i),f.populateIdentities(),f.changeEditedAccount(s),1===f.collection().length&&f.changeCurrentAccount(s),this.fCallback&&this.fCallback(s),this.closePopup()}else c.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_CREATE_ACCOUNT"))},v.prototype.editAccount=function(e){g.run("SettingsWebclient","setAddHash",[["account",e]])},e.exports=new v},KmL1:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("9kOp"),n=s("/QeJ"),a=s("TdEd"),l=s("o1lX"),h=s("skxT"),c=s("H20a"),u=s("7xgn"),d=s("oFXy"),p=s("QaEg"),m=s("EFhx");function g(){l.call(this),this.iAccountId=0,this.aliasName=o.observable(""),this.loading=o.observable(!1),this.selectedDomain=o.observable(null),this.domainList=o.observableArray([])}i.extendOwn(g.prototype,l.prototype),g.prototype.PopupTemplate="MailWebclient_Settings_CreateAliasPopup",g.prototype.onOpen=function(e){this.iAccountId=e,this.getDomainList()},g.prototype.onClose=function(){this.aliasName("")},g.prototype.save=function(){if(""===this.aliasName())h.showError(c.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY"));else{var e={AliasName:this.aliasName(),AliasDomain:this.selectedDomain()};this.loading(!0),m.send(d.AliasesServerModuleName,"AddNewAlias",e,this.onCreateAliasResponse,this)}},g.prototype.getDomainList=function(){var e=u.getCurrent().serverId(),t=i.isFunction(r.getTenantId)?r.getTenantId():0;p.send("GetServerDomains",{ServerId:e,TenantId:t},this.onGetDomainListResponse,this)},g.prototype.onGetDomainListResponse=function(e,t){e.Result&&this.domainList(e.Result)},g.prototype.onCreateAliasResponse=function(e,t){this.loading(!1),e.Result?(u.populateAliases((function(){var t=u.getCurrent().aliases(),s=i.find(t,(function(t){return t.id()===e.Result}));s&&a.run("SettingsWebclient","setAddHash",[["alias",s.hash()]])})),this.closePopup()):n.showErrorByCode(e,c.i18n("COREWEBCLIENT/ERROR_UNKNOWN"))},e.exports=new g},hXOA:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("REt5"),l=s("/QeJ"),h=s("skxT"),c=s("EFhx"),u=s("oUN1"),d=s("o1lX"),p=s("WBAn"),m=s("7xgn"),g=s("F0Fd"),b=s("oFXy"),f=s("DBk0");function S(){d.call(this),this.iAccountId=0,this.loading=r.observable(!1),this.newFolderCreating=r.observable(!1),this.incomingLogin=r.observable(""),this.incomingPassword=r.observable(""),this.oIncoming=new f(110,995,"fectcher_add_incoming",n.i18n("MAILWEBCLIENT/LABEL_POP3_SERVER")),this.folder=r.observable(""),this.options=r.observableArray([]),g.folderList.subscribe((function(){this.populateOptions()}),this),this.addNewFolderCommand=a.createCommand(this,this.onAddNewFolderClick),this.leaveMessagesOnServer=r.observable(!1),this.loginIsSelected=r.observable(!1),this.passwordIsSelected=r.observable(!1),this.defaultOptionsAfterRender=a.defaultOptionsAfterRender}i.extendOwn(S.prototype,d.prototype),S.prototype.PopupTemplate="MailWebclient_Settings_CreateFetcherPopup",S.prototype.onOpen=function(e){this.iAccountId=e,this.bShown=!0,this.populateOptions(),this.incomingLogin(""),this.incomingPassword(""),this.oIncoming.clear(),this.folder(""),this.leaveMessagesOnServer(!0)},S.prototype.populateOptions=function(){this.bShown&&this.options(g.folderList().getOptions("",!0,!1,!1))},S.prototype.onClose=function(){this.bShown=!1},S.prototype.save=function(){if(this.isEmptyRequiredFields())h.showError(n.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY"));else{var e={AccountId:this.iAccountId,Folder:this.folder(),IncomingServer:this.oIncoming.server(),IncomingPort:this.oIncoming.getIntPort(),IncomingUseSsl:this.oIncoming.ssl(),IncomingLogin:o.trim(this.incomingLogin()),IncomingPassword:o.trim(this.incomingPassword()),LeaveMessagesOnServer:this.leaveMessagesOnServer()};this.loading(!0),c.send(b.FetchersServerModuleName,"CreateFetcher",e,this.onCreateFetcherResponse,this)}},S.prototype.onCreateFetcherResponse=function(e,t){this.loading(!1),e.Result?(m.populateFetchers(),this.closePopup()):l.showErrorByCode(e,n.i18n("COREWEBCLIENT/ERROR_UNKNOWN"))},S.prototype.cancelPopup=function(){this.newFolderCreating()||this.closePopup()},S.prototype.isEmptyRequiredFields=function(){switch(""){case this.oIncoming.server():return this.oIncoming.server.focused(!0),!0;case o.trim(this.incomingLogin()):return this.loginIsSelected(!0),!0;case o.trim(this.incomingPassword()):return this.passwordIsSelected(!0),!0;default:return!1}},S.prototype.onAddNewFolderClick=function(){this.newFolderCreating(!0),u.showPopup(p,[i.bind(this.chooseFolderInList,this)])},S.prototype.chooseFolderInList=function(e,t){var s=g.folderList().sDelimiter,o=[];""!==e&&""!==t&&(this.options(g.folderList().getOptions("",!0,!1,!1)),i.each(this.options(),i.bind((function(i){e===i.name&&((o=i.fullName.split(s)).pop(),t===o.join(s)&&this.folder(i.fullName))}),this))),this.newFolderCreating(!1)},e.exports=new S},WBAn:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("REt5"),a=s("/QeJ"),l=s("o1lX"),h=s("7xgn"),c=s("QaEg"),u=s("F0Fd");function d(){l.call(this),this.isCreating=o.observable(!1),u.folderListLoading.subscribe((function(){-1===u.folderListLoading.indexOf(u.editedFolderList().iAccountId)&&this.isCreating()&&(i.isFunction(this.fCallback)&&this.fCallback(this.folderName(),this.parentFolder()),this.isCreating(!1),this.closePopup())}),this),this.options=o.observableArray([]),this.parentFolder=o.observable(""),this.folderName=o.observable(""),this.folderNameFocus=o.observable(!1),this.fCallback=null,this.defaultOptionsAfterRender=n.defaultOptionsAfterRender}i.extendOwn(d.prototype,l.prototype),d.prototype.PopupTemplate="MailWebclient_Settings_CreateFolderPopup",d.prototype.onOpen=function(e){this.options(u.editedFolderList().getOptions(r.i18n("MAILWEBCLIENT/LABEL_NO_PARENT_FOLDER"),!0,!1,!0)),this.fCallback=e,this.folderName(""),this.folderNameFocus(!0)},d.prototype.create=function(){var e=""===this.parentFolder()?u.editedFolderList().sNamespaceFolder:this.parentFolder(),t={AccountID:h.editedId(),FolderNameInUtf8:this.folderName(),FolderParentFullNameRaw:e,Delimiter:u.editedFolderList().sDelimiter};this.folderNameFocus(!1),this.isCreating(!0),c.send("CreateFolder",t,this.onCreateFolderResponse,this)},d.prototype.onCreateFolderResponse=function(e,t){e.Result?u.getFolderList(h.editedId()):(this.isCreating(!1),a.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_CREATE_FOLDER")))},d.prototype.cancelPopup=function(){this.isCreating()||(i.isFunction(this.fCallback)&&this.fCallback("",""),this.closePopup())},e.exports=new d},exVY:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("o1lX"),r=s("7xgn"),n=s("ce4k"),a=s("ZS9T");function l(){o.call(this),this.oIdentitySettingsFormView=new a(this,!0)}i.extendOwn(l.prototype,o.prototype),l.prototype.PopupTemplate="MailWebclient_Settings_CreateIdentityPopup",l.prototype.onOpen=function(e){var t=r.getAccount(e),s=new n;s.accountId(e),s.email(t.email()),this.oIdentitySettingsFormView.onShow(s),this.oIdentitySettingsFormView.populate(),this.oIdentitySettingsFormView.friendlyNameHasFocus(!0)},e.exports=new l},frS4:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("REt5"),a=s("/QeJ"),l=s("o1lX"),h=s("7xgn"),c=s("QaEg"),u=s("F0Fd"),d=s("oFXy");function p(){l.call(this),this.folders=u.editedFolderList,this.sentFolderFullName=o.observable(""),this.draftsFolderFullName=o.observable(""),this.spamFolderFullName=o.observable(""),this.trashFolderFullName=o.observable(""),this.options=o.observableArray([]),this.defaultOptionsAfterRender=n.defaultOptionsAfterRender,this.bAllowSpamFolderEditing=d.AllowSpamFolder}i.extendOwn(p.prototype,l.prototype),p.prototype.PopupTemplate="MailWebclient_Settings_SetSystemFoldersPopup",p.prototype.onOpen=function(){var e=u.editedFolderList();this.options(e.getOptions(r.i18n("MAILWEBCLIENT/LABEL_NO_FOLDER_USAGE_ASSIGNED"),!1,!1,!1)),this.sentFolderFullName(e.sentFolderFullName()),this.draftsFolderFullName(e.draftsFolderFullName()),d.AllowSpamFolder&&this.spamFolderFullName(e.spamFolderFullName()),this.trashFolderFullName(e.trashFolderFullName())},p.prototype.onResponseFoldersSetupSystem=function(e,t){!1===e.Result&&(a.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_SETUP_SPECIAL_FOLDERS")),u.getFolderList(h.editedId()))},p.prototype.apply=function(){var e=u.editedFolderList(),t=!1,s=null;this.sentFolderFullName()!==e.sentFolderFullName()&&(e.sentFolderFullName(this.sentFolderFullName()),t=!0),this.draftsFolderFullName()!==e.draftsFolderFullName()&&(e.draftsFolderFullName(this.draftsFolderFullName()),t=!0),d.AllowSpamFolder&&this.spamFolderFullName()!==e.spamFolderFullName()&&(e.spamFolderFullName(this.spamFolderFullName()),t=!0),this.trashFolderFullName()!==e.trashFolderFullName()&&(e.trashFolderFullName(this.trashFolderFullName()),t=!0),t&&(s={AccountID:h.editedId(),Sent:e.sentFolderFullName(),Drafts:e.draftsFolderFullName(),Trash:e.trashFolderFullName(),Spam:e.spamFolderFullName()},c.send("SetupSystemFolders",s,this.onResponseFoldersSetupSystem,this)),this.closePopup()},e.exports=new p},"7+7L":(e,t,s)=>{"use strict";var i=s("REt5"),o=s("OfVV"),r=s("sdEb"),n={},a="YYYY.MM.DD";n.formattedDateSearchHighlightedInput=function(e){const t=i.getDateFormatForMoment(o.dateFormat()),s=e.match(/date:([^/]*)(\/([^/]*))?/);let n="",l="";if(s){const e=r(s[1],a);n=e.isValid()?e.format(t):s[1];const i=r(s[3],a);l=i.isValid()?i.format(t):s[3]}if(!n&&!l)return e;const h=e.match(/(\w+):(\S+)/g),c=[];return h&&h.forEach((e=>{const t=e.split(":"),s="date"===t[0]?n+" - "+l:t[1];c.push(t[0]+":"+s)})),c.join(" ")},n.changeDateStartAndDateEndformatForSend=function(e,t){const s=r(e?.trim(),i.getDateFormatForMoment(o.dateFormat())),n=r(t?.trim(),i.getDateFormatForMoment(o.dateFormat()));return[s.isValid()&&s.format(a)||"",n.isValid()&&n.format(a)||""]},e.exports=n},"66Za":(e,t,s)=>{var i,o,r;o=[s("p09A"),s("M4cL"),s("Hg/X"),s("6gxe"),s("O/kJ")],void 0===(r="function"==typeof(i=function(e,t){var s="ko_sortItem",i="ko_sourceIndex",o="ko_sortList",r="ko_parentList",n=e.utils.unwrapObservable,a=e.utils.domData.get,l=e.utils.domData.set,h=t.ui&&t.ui.version,c=h&&h.indexOf("1.6.")&&h.indexOf("1.7.")&&(h.indexOf("1.8.")||"1.8.24"===h),u=function(t,i){e.utils.arrayForEach(t,(function(e){1===e.nodeType&&(l(e,s,i),l(e,r,a(e.parentNode,o)))}))},d=function(t,s){var i,o={},r={};return e.utils.peekObservable(t()).data?(r=n(t()||{}),o[s]=r.data,r.hasOwnProperty("template")&&(o.name=r.template)):o[s]=t(),e.utils.arrayForEach(["afterAdd","afterRender","as","beforeRemove","includeDestroyed","templateEngine","templateOptions","nodes"],(function(t){r.hasOwnProperty(t)?o[t]=r[t]:e.bindingHandlers.sortable.hasOwnProperty(t)&&(o[t]=e.bindingHandlers.sortable[t])})),"foreach"===s&&(o.afterRender?(i=o.afterRender,o.afterRender=function(e,t){u.call(t,e,t),i.call(t,e,t)}):o.afterRender=u),o},p=function(e,t){var s=n(t);if(s)for(var i=0;i<=e;i++)s[i]&&n(s[i]._destroy)&&e++;return e};e.bindingHandlers.sortable={init:function(h,u,m,g,b){var f,S,E=t(h),A=n(u())||{},v=d(u,"foreach"),y={};(function(s,i){var o,r;i?(r=document.getElementById(i))&&(o=new e.templateSources.domElement(r)).text(t.trim(o.text())):t(s).contents().each((function(){this&&1!==this.nodeType&&s.removeChild(this)}))})(h,v.name),t.extend(!0,y,e.bindingHandlers.sortable),A.options&&y.options&&(e.utils.extend(y.options,A.options),delete A.options),e.utils.extend(y,A),y.connectClass&&(e.isObservable(y.allowDrop)||"function"==typeof y.allowDrop)?e.computed({read:function(){var t=n(y.allowDrop),s="function"==typeof t?t.call(this,v.foreach):t;e.utils.toggleDomNodeCssClass(h,y.connectClass,s)},disposeWhenNodeIsRemoved:h},this):e.utils.toggleDomNodeCssClass(h,y.connectClass,y.allowDrop),e.bindingHandlers.template.init(h,(function(){return v}),m,g,b),f=y.options.start,S=y.options.update,y.options.helper||(y.options.helper=function(e,s){return s.is("tr")&&s.children().each((function(){t(this).width(t(this).width())})),s});var I=setTimeout((function(){var u,d=y.options.receive;E.sortable(e.utils.extend(y.options,{start:function(t,s){var o=s.item[0];l(o,i,e.utils.arrayIndexOf(s.item.parent().children(),o)),s.item.find("input:focus").change(),f&&f.apply(this,arguments)},receive:function(e,t){"function"==typeof d&&d.call(this,e,t),(u=a(t.item[0],"ko_dragItem"))&&(u.clone&&(u=u.clone()),y.dragged&&(u=y.dragged.call(this,u,e,t)||u))},update:function(h,d){var m,g,b,f,E,A=d.item[0],I=d.item.parent()[0],F=a(A,s)||u;if(F||t(A).remove(),u=null,F&&this===I||!c&&t.contains(this,I)){if(m=a(A,r),b=a(A,i),g=a(A.parentNode,o),f=e.utils.arrayIndexOf(d.item.parent().children(),A),v.includeDestroyed||(b=p(b,m),f=p(f,g)),(y.beforeMove||y.afterMove)&&(E={item:F,sourceParent:m,sourceParentNode:m&&d.sender||A.parentNode,sourceIndex:b,targetParent:g,targetIndex:f,cancelDrop:!1},y.beforeMove&&y.beforeMove.call(this,E,h,d)),m?t(m===g?this:d.sender||this).sortable("cancel"):t(A).remove(),E&&E.cancelDrop)return;if(y.hasOwnProperty("strategyMove")&&!1!==y.strategyMove){if(f>=0)if(m)if(m!==g)m.splice(b,1),g.splice(f,0,F),l(A,s,null),d.item.remove();else{var C=n(m);m.valueWillMutate&&m.valueWillMutate(),C.splice(b,1),C.splice(f,0,F),m.valueHasMutated&&m.valueHasMutated()}else g.splice(f,0,F),l(A,s,null),d.item.remove()}else f>=0&&(m&&(m.splice(b,1),e.processAllDeferredBindingUpdates&&e.processAllDeferredBindingUpdates(),e.options&&e.options.deferUpdates&&e.tasks.runEarly()),g.splice(f,0,F)),l(A,s,null);e.processAllDeferredBindingUpdates&&e.processAllDeferredBindingUpdates(),y.afterMove&&y.afterMove.call(this,E,h,d)}S&&S.apply(this,arguments)},connectWith:!!y.connectClass&&"."+y.connectClass})),void 0!==y.isEnabled&&e.computed({read:function(){E.sortable(n(y.isEnabled)?"enable":"disable")},disposeWhenNodeIsRemoved:h})}),0);return e.utils.domNodeDisposal.addDisposeCallback(h,(function(){(E.data("ui-sortable")||E.data("sortable"))&&E.sortable("destroy"),e.utils.toggleDomNodeCssClass(h,y.connectClass,!1),clearTimeout(I)})),{controlsDescendantBindings:!0}},update:function(t,s,i,r,n){var a=d(s,"foreach");l(t,o,a.foreach),e.bindingHandlers.template.update(t,(function(){return a}),i,r,n)},connectClass:"ko_container",allowDrop:!0,afterMove:null,beforeMove:null,options:{}}})?i.apply(t,o):i)||(e.exports=r)},zwBT:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("9kOp"),a=s("TdEd"),l=s("W66n"),h=s("skxT"),c=s("OfVV"),u=s("oUN1"),d=s("WBAn"),p=s("7xgn"),m=s("F0Fd"),g=s("oFXy");function b(){this.folderList=m.folderList,this.folderFullName=o.computed((function(){var e=m.getCurrentFolder();return e?e.fullName():""}),this),this.unifiedInboxAllowed=p.unifiedInboxAllowed,this.oUnifiedInbox=m.oUnifiedInbox,this.manageFoldersHash=o.computed((function(){if(a.isModuleEnabled("SettingsWebclient")){var e=p.getCurrent();if(e&&e.allowManageFolders())return l.buildHashFromArray(["settings","mail-accounts","account",e.hash(),"folders"])}return"#"}),this),this.quotaProc=o.observable(-1),this.quotaDesc=o.observable(""),this.bShowQuotaBarTextAsTooltip=c.ShowQuotaBarTextAsTooltip,c.ShowQuotaBar&&o.computed((function(){m.quotaChangeTrigger();var e=p.getCurrent(),t=e?e.quota():0,s=e?e.usedSpace():0,i=0<t?Math.ceil(s/t*100):-1;return i=100<i?100:i,this.quotaProc(i),this.quotaDesc(-1<i?r.i18n("COREWEBCLIENT/INFO_QUOTA",{PROC:i,QUOTA:r.getFriendlySize(1024*t)}):""),c.QuotaWarningPerc>0&&-1!==i&&c.QuotaWarningPerc>100-i&&h.showError(r.i18n("COREWEBCLIENT/WARNING_QUOTA_ALMOST_REACHED"),!0),!0}),this),this.visibleNewFolderButton=o.computed((function(){return g.AllowAddNewFolderOnMainScreen&&this.folderList().collection().length>0}),this),this.underNewMessageButtonControllers=o.observableArray([]),this.underInboxFolderControllers=o.observableArray([]),this.folderListControllers=o.computed((function(){return this.underNewMessageButtonControllers().concat(this.underInboxFolderControllers())}),this),n.broadcastEvent("MailWebclient::RegisterFolderListController",i.bind((function(e,t){this.registerController(e,t)}),this))}b.prototype.ViewTemplate="MailWebclient_FoldersView",b.prototype.onShow=function(){this.folderListControllers().forEach((e=>{i.isFunction(e.onShow)&&e.onShow()}))},b.prototype.onRoute=function(e){this.folderListControllers().forEach((t=>{i.isFunction(t.onRoute)&&t.onRoute(e)}))},b.prototype.addNewFolder=function(){u.showPopup(d)},b.prototype.registerController=function(e,t){switch(t){case"UnderNewMessageButton":this.underNewMessageButtonControllers.push(e);break;case"UnderInboxFolder":this.underInboxFolderControllers.push(e)}},e.exports=b},fveu:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("REt5"),h=s("9kOp"),c=s("W66n"),u=s("mGms"),d=s("doeu"),p=s("B5X4"),m=s("CPab"),g=s("7xgn"),b=s("F0Fd"),f=s("oFXy"),S=s("zwBT"),E=s("q9v7"),A=s("kb14");function v(){d.call(this,"MailWebclient"),h.broadcastEvent("MailWebclient::ConstructView::before",{Name:this.ViewConstructorName,View:this,MailCache:b}),this.browserTitle=r.computed((function(){return g.getEmail()+" - "+n.i18n("MAILWEBCLIENT/HEADING_BROWSER_TAB")})),this.folderList=b.folderList,this.domFoldersMoveTo=r.observable(null),this.openMessageInNewWindowBound=i.bind(this.openMessageInNewWindow,this),this.oFolderList=new S,this.isUnifiedFolderCurrent=b.oUnifiedInbox.selected,this.oBaseMessageList=new E(this.openMessageInNewWindowBound),this.messageList=r.observable(this.oBaseMessageList),this.isSearchMultiFolders=r.computed((function(){return this.messageList().searchFoldersMode()===Enums.SearchFoldersMode.Sub||this.messageList().searchFoldersMode()===Enums.SearchFoldersMode.All}),this),this.oBaseMessagePaneView=A,this.messagePane=r.observable(this.oBaseMessagePaneView),this.messagePane().openMessageInNewWindowBound=this.openMessageInNewWindowBound,this.messagePane.subscribe((function(){this.bindMessagePane(),this.messagePane().expandMessagePaneWidth=this.expandMessagePaneWidth}),this),this.expandListPaneWidth=r.observable(!1),this.expandMessagePaneWidth=r.observable(!1),this.messagePane().expandMessagePaneWidth=this.expandMessagePaneWidth,b.currentMessage.subscribe((function(){b.currentMessage()||this.expandMessagePaneWidth(!1)}),this),this.isEnableGroupOperations=r.computed((()=>this.messageList().isEnableGroupOperations())),this.sCustomBigButtonModule="",this.fCustomBigButtonHandler=null,this.customBigButtonText=r.observable(""),this.bigButtonCommand=l.createCommand(this,(function(){i.isFunction(this.fCustomBigButtonHandler)?this.fCustomBigButtonHandler():this.executeCompose()})),this.bigButtonText=r.computed((function(){return""!==this.customBigButtonText()?this.customBigButtonText():n.i18n("MAILWEBCLIENT/ACTION_NEW_MESSAGE")}),this),this.isTemplateFolder=r.computed((function(){return b.isTemplateFolder(b.getCurrentFolderFullname())}),this),this.checkMailCommand=l.createCommand(this,this.executeCheckMail),this.checkMailIndicator=r.observable(!0).extend({throttle:50}),r.computed((function(){this.checkMailIndicator(b.checkMailStarted()||b.messagesLoading())}),this),this.customModulesDisabledMark=r.observableArray([]),this.visibleMarkTool=r.computed((function(){return!this.isTemplateFolder()&&!a.isNonEmptyArray(this.customModulesDisabledMark())}),this),this.markAsReadCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeMarkAsRead()}),this.isEnableGroupOperations),this.markAsUnreadCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeMarkAsUnread()}),this.isEnableGroupOperations),this.markAllReadCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeMarkAllRead()})),this.customModulesDisabledMove=r.observableArray([]),this.visibleMoveTool=r.computed((function(){return!b.oUnifiedInbox.selected()&&!a.isNonEmptyArray(this.customModulesDisabledMove())}),this),this.needToCopyDraggedItems=r.observable(!1),this.moveToFolderTemplate="MailWebclient_Messages_MoveButtonView",this.moveToFolderCommand=l.createCommand(this,(function(){}),this.isEnableGroupOperations),this.deleteCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeDelete()}),this.isEnableGroupOperations),this.selectedCount=r.computed((function(){return this.messageList().checkedUids().length}),this),this.emptyTrashCommand=l.createCommand(b,b.executeEmptyTrash,(()=>this.messageList().isNotEmptyList())),this.emptySpamCommand=l.createCommand(b,b.executeEmptySpam,(()=>this.messageList().isNotEmptyList())),this.spamCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeSpam()}),this.isEnableGroupOperations),this.notSpamCommand=l.createCommand(this.messageList(),(()=>{this.messageList().executeNotSpam()}),this.isEnableGroupOperations),this.isSpamFolder=r.computed((function(){return b.getCurrentFolderType()===Enums.FolderTypes.Spam}),this),this.customModulesDisabledSpam=r.observableArray([]),this.allowedSpamAction=r.computed((function(){return f.AllowSpamFolder&&this.folderList().spamFolder()&&!this.isSpamFolder()&&!this.isTemplateFolder()&&!a.isNonEmptyArray(this.customModulesDisabledSpam())}),this),this.allowedNotSpamAction=r.computed((function(){return f.AllowSpamFolder&&this.isSpamFolder()&&!this.isTemplateFolder()}),this),this.isTrashFolder=r.computed((function(){return b.getCurrentFolderType()===Enums.FolderTypes.Trash}),this),f.HorizontalLayout&&o("html").addClass("layout-horiz-split"),h.subscribeEvent("CoreWebclient::GetDebugInfo",i.bind((function(e){e.Info.push("checkMailStarted: "+b.checkMailStarted()+", messagesLoading: "+b.messagesLoading())}),this)),h.broadcastEvent("MailWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}i.extendOwn(v.prototype,d.prototype),v.prototype.ViewTemplate=f.HorizontalLayout?"MailWebclient_MailHorizontalLayoutView":"MailWebclient_MailView",v.prototype.ViewConstructorName="CMailView",v.prototype.hasUnsavedChanges=function(){return this.messagePane()&&i.isFunction(this.messagePane().hasUnsavedChanges)&&this.messagePane().hasUnsavedChanges()},v.prototype.discardChanges=function(){this.messagePane()&&i.isFunction(this.messagePane().discardChanges)&&this.messagePane().discardChanges()},v.prototype.setCustomPreviewPane=function(e,t){this.messagePane().__customModuleName!==e&&(i.isFunction(this.messagePane().onHide)&&this.messagePane().onHide(),t.__customModuleName=e,this.messagePane(t),i.isFunction(this.messagePane().onShow)&&this.messagePane().onShow())},v.prototype.removeCustomPreviewPane=function(e){this.messagePane().__customModuleName===e&&(i.isFunction(this.messagePane().onHide)&&this.messagePane().onHide(),this.messagePane(this.oBaseMessagePaneView),i.isFunction(this.messagePane().onShow)&&this.messagePane().onShow())},v.prototype.setCustomMessageList=function(e,t){this.messageList().__customModuleName!==e&&(t.__customModuleName=e,this.changeMessageList(t))},v.prototype.removeCustomMessageList=function(e){this.messageList().__customModuleName===e&&this.changeMessageList(this.oBaseMessageList)},v.prototype.changeMessageList=function(e){i.isFunction(this.messageList().onHide)&&this.messageList().onHide(),i.isFunction(this.messageList().unbind)&&this.messageList().unbind(),this.messageList(e),i.isFunction(this.messageList().onBind)&&this.messageList().onBind(this.$viewDom),i.isFunction(this.messageList().onShow)&&this.messageList().onShow()},v.prototype.setCustomBigButton=function(e,t,s){this.sCustomBigButtonModule=e,this.fCustomBigButtonHandler=t,this.customBigButtonText(s)},v.prototype.removeCustomBigButton=function(e){this.sCustomBigButtonModule===e&&(this.sCustomBigButtonModule="",this.fCustomBigButtonHandler=null,this.customBigButtonText(""))},v.prototype.resetDisabledTools=function(e,t){-1!==o.inArray("spam",t)?this.customModulesDisabledSpam(i.union(this.customModulesDisabledSpam(),[e])):this.customModulesDisabledSpam(i.without(this.customModulesDisabledSpam(),e)),-1!==o.inArray("move",t)?this.customModulesDisabledMove(i.union(this.customModulesDisabledMove(),[e])):this.customModulesDisabledMove(i.without(this.customModulesDisabledMove(),e)),-1!==o.inArray("mark",t)?this.customModulesDisabledMark(i.union(this.customModulesDisabledMark(),[e])):this.customModulesDisabledMark(i.without(this.customModulesDisabledMark(),e))},v.prototype.executeCompose=function(){p.composeMessage()},v.prototype.executeCheckMail=function(){b.checkMessageFlags(),b.executeCheckMail(!0)},v.prototype.openMessageInNewWindow=function(e){if(e&&e.longUid){var t=e.accountId(),s=e.folder(),o=e.longUid(),r=this.folderList().getFolderByFullName(s),n=r?.type()===Enums.FolderTypes.Drafts,a="";this.isUnifiedFolderCurrent()&&(s=b.oUnifiedInbox.fullName(),n=!1),n?a=c.buildHashFromArray(m.getComposeFromMessage("drafts",t,s,o)):(a=c.buildHashFromArray(m.getViewMessage(t,s,o)),i.isFunction(this.messagePane().passReplyDataToNewTab)&&this.messagePane().passReplyDataToNewTab(e.longUid())),u.openTab("?message-newtab"+a)}},v.prototype.resizeDblClick=function(e,t){l.calmEvent(t),l.removeSelection(),this.expandListPaneWidth(!this.expandListPaneWidth())},v.prototype.onRoute=function(e){if(g.hasAccount()){var t=m.parseMailbox(e);g.changeCurrentAccountByHash(t.AccountHash),i.isFunction(this.oFolderList.onRoute)&&this.oFolderList.onRoute(e),this.messageList().onRoute(e),i.isFunction(this.messagePane().onRoute)&&this.messagePane().onRoute(e,t),t.MailtoCompose&&(h.isMobile()?(e=m.getComposeWithToField(e[2]),c.replaceHash(e),setTimeout((function(){c.clearPreviousHash()}),0)):(p.composeMessageToAddresses(e[2]),c.replaceHash(m.getMailbox())))}else c.replaceHash(["settings","mail-accounts","account","create"])},v.prototype.onShow=function(){i.isFunction(this.oFolderList.onShow)&&this.oFolderList.onShow(),this.messageList().onShow(),i.isFunction(this.messagePane().onShow)&&this.messagePane().onShow()},v.prototype.onHide=function(){this.messageList().onHide(),i.isFunction(this.messagePane().onHide)&&this.messagePane().onHide()},v.prototype.bindMessagePane=function(){i.isFunction(this.messagePane().onBind)&&(this.messagePane().onBind(this.$viewDom),this.messagePane().__bound=!0)},v.prototype.onBind=function(){var e=this.messageList();e.onBind(this.$viewDom),this.bindMessagePane(),o(this.domFoldersMoveTo()).on("click","span.folder",(function(t){var s=o(this).data("folder");b.getCurrentFolderFullname()!==s&&(t.ctrlKey?e.executeCopyToFolder(s):e.executeMoveToFolder(s))})),h.isMobile()||this.hotKeysBind()},v.prototype.hotKeysBind=function(){o(document).on("keydown",o.proxy((function(e){var t=e.keyCode,s=e&&!e.ctrlKey&&!e.altKey&&!e.shiftKey&&!l.isTextFieldFocused()&&this.shown(),i=this.messageList(),o=i.collection()[0],r=o&&b.currentMessage()&&o.longUid()===b.currentMessage().longUid();s&&t===Enums.Key.s||s&&r&&t===Enums.Key.Up?(e.preventDefault(),this.searchFocus()):i.isFocused()&&e&&t===Enums.Key.Down&&o?(e.preventDefault(),i.isFocused(!1),i.routeForMessage(o)):s&&t===Enums.Key.n&&(this.executeCompose(),e.preventDefault())}),this))},v.prototype.routeMessageView=function(e,t){c.setHash(m.getMailbox(e,this.messageList().oPageSwitcher.currentPage(),t))},v.prototype.dragAndDropHelper=function(e,t){e&&e.checked(!0);var s=l.draggableItems(),i=this.messageList().checkedOrSelectedUids(),r=i.length;return s.data("p7-message-list-folder",b.getCurrentFolderFullname()),s.data("p7-message-list-uids",i),this.needToCopyDraggedItems(t),o(".count-text",s).text(n.i18n("MAILWEBCLIENT/LABEL_DRAG_MESSAGES_PLURAL",{COUNT:t?"+ "+r:r},null,r)),s},v.prototype.messagesDrop=function(e,t,s){if(e){var i=s&&s.helper?s.helper:null,o=i?i.data("p7-message-list-folder"):"",r=i?i.data("p7-message-list-uids"):null;o&&r&&(l.uiDropHelperAnim(t,s),this.needToCopyDraggedItems()?this.messageList().executeCopyToFolder(e.fullName()):this.messageList().executeMoveToFolder(e.fullName()),this.uncheckMessages())}},v.prototype.searchFocus=function(){this.messageList().selector.useKeyboardKeys()&&!l.isTextFieldFocused()&&this.messageList().isFocused(!0)},v.prototype.onVolumerClick=function(e,t){t.stopPropagation()},v.prototype.uncheckMessages=function(){i.each(b.messages(),(function(e){e.checked(!1)}))},e.exports=v},q9v7:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("sdEb"),a=s("REt5"),l=s("injE"),h=s("H20a"),c=s("KC/L"),u=s("/QeJ"),d=s("9kOp"),p=s("dfnr"),m=s("qBBW"),g=s("vdUg"),b=s("TdEd"),f=s("W66n"),S=s("skxT"),E=s("OfVV"),A=s("jNBr"),v=s("yKBN"),y=s("B5X4"),I=s("CPab"),F=s("WOsA"),C=s("7+7L"),M=s("7xgn"),T=s("F0Fd"),L=s("oFXy"),w=s("A3in");function R(e){this.disableMoveMessages=r.computed((function(){var e=T.getCurrentFolder();return!e||e.disableMoveFrom()}),this),this.bVisibleSortByTool=L.MessagesSortBy.Allow&&L.MessagesSortBy.List.length>0,this.sSortBy=L.MessagesSortBy.DefaultSortBy,this.iSortOrder=L.MessagesSortBy.DefaultSortOrder,this.sortBy=r.observable(L.MessagesSortBy.DefaultSortBy),this.sortOrder=r.observable(L.MessagesSortBy.DefaultSortOrder),this.aSortList=[],i.each(L.MessagesSortBy.List,function(e){this.aSortList.push({sText:h.i18n("MAILWEBCLIENT/"+e.LangConst),sSortBy:e.SortBy})}.bind(this)),this.uploaderArea=r.observable(null),this.bDragActive=r.observable(!1),this.bDragActiveComp=r.computed((function(){return this.bDragActive()}),this),this.openMessageInNewWindowBound=e,this.isFocused=r.observable(!1),this.messagesContainer=r.observable(null),this.currentMessage=T.currentMessage,this.currentMessage.subscribe((function(){this.isFocused(!1),this.selector.itemSelected(this.currentMessage())}),this),this.folderList=T.folderList,this.folderList.subscribe((function(){setTimeout(this.onFolderListSubscribe.bind(this))}),this),this.folderFullName=r.observable(""),this.folderType=r.observable(Enums.FolderTypes.User),this.filters=r.observable(""),this.isStarredFolder=r.computed((()=>this.filters()===Enums.FolderFilter.Flagged)),this.isStarredInAllFolders=r.computed((()=>this.isStarredFolder()&&L.AllowChangeStarredMessagesSource&&L.StarredMessagesSource===Enums.StarredMessagesSource.AllFolders)),this.isStarredFolder.subscribe((()=>{this.isStarredFolder()&&this.selectedSearchFoldersMode(this.isStarredInAllFolders()?"all":"")})),this.allowAdvancedSearch=r.computed((function(){return!b.isModuleIncluded("MailNotesPlugin")||"Notes"!==this.folderFullName()}),this),this.searchHighlightedInputFormatted=r.observable(""),this.searchHighlightedInput=r.observable(""),this.searchHighlightedInput.subscribe((()=>{this.searchHighlightedInputFormatted(C.formattedDateSearchHighlightedInput(this.searchHighlightedInput()))})),this.searchInput=r.computed({read:()=>this.isStarredInAllFolders()?`${this.searchHighlightedInputFormatted()} folders:all`:this.searchHighlightedInputFormatted(),write:e=>{this.isStarredInAllFolders()?this.searchHighlightedInput(e.replace("folders:all","")):this.searchHighlightedInput(e)}}),this.searchInputFrom=r.observable(""),this.searchInputTo=r.observable(""),this.searchInputSubject=r.observable(""),this.searchInputText=r.observable(""),this.searchSpan=r.observable(""),this.highlightTrigger=r.observable(""),this.selectedSearchFoldersMode=r.observable(""),this.selectedSearchFoldersModeText=r.computed((function(){return this.selectedSearchFoldersMode()===Enums.SearchFoldersMode.Sub?h.i18n("MAILWEBCLIENT/LABEL_SEARCH_CURRENT_FOLDER_AND_SUBFOLDERS"):this.selectedSearchFoldersMode()===Enums.SearchFoldersMode.All?h.i18n("MAILWEBCLIENT/LABEL_SEARCH_ALL_FOLDERS"):h.i18n("MAILWEBCLIENT/LABEL_SEARCH_CURRENT_FOLDER")}),this),this.uidList=T.uidList,this.uidList.subscribe((function(){this.uidList().searchCountSubscription&&(this.uidList().searchCountSubscription.dispose(),this.uidList().searchCountSubscription=void 0),this.uidList().searchCountSubscription=this.uidList().resultCount.subscribe((function(){this.uidList().resultCount()>=0&&this.oPageSwitcher.setCount(this.uidList().resultCount())}),this),this.uidList().resultCount()>=0&&this.oPageSwitcher.setCount(this.uidList().resultCount())}),this),this.useThreading=r.computed((function(){var e=M.getCurrent(),t=T.getCurrentFolder(),s=t&&t.withoutThreads(),i=""===this.uidList().search()&&""===this.uidList().filters();return e&&e.threadingIsAvailable()&&!s&&i}),this),this.collection=T.messages,this._search=r.observable(""),this.search=r.computed({read:function(){return o.trim(this._search())},write:this._search,owner:this}),this.searchFoldersMode=r.observable(""),this.messageListParamsChanged=r.observable(!1).extend({autoResetToFalse:100}),this.isEmptyList=r.computed((function(){return 0===this.collection().length}),this),this.isNotEmptyList=r.computed((function(){return 0!==this.collection().length}),this),this.isSearch=r.computed((function(){return this.search().length>0}),this),this.isUnseenFilter=r.computed((function(){return this.filters()===Enums.FolderFilter.Unseen}),this),this.isLoading=T.messagesLoading,this.isError=T.messagesLoadingError,this.visibleInfoLoading=r.computed((function(){return!this.isSearch()&&this.isLoading()}),this),this.visibleInfoSearchLoading=r.computed((function(){return this.isSearch()&&this.isLoading()}),this),this.visibleInfoSearchList=r.computed((function(){return this.isSearch()&&!this.isUnseenFilter()&&!this.isLoading()&&!this.isEmptyList()}),this),this.visibleInfoMessageListEmpty=r.computed((function(){return!this.isLoading()&&!this.isSearch()&&""===this.filters()&&this.isEmptyList()&&!this.isError()}),this),this.visibleInfoStarredFolderEmpty=r.computed((function(){return!this.isLoading()&&!this.isSearch()&&this.isStarredFolder()&&this.isEmptyList()&&!this.isError()}),this),this.visibleInfoSearchEmpty=r.computed((function(){return this.isSearch()&&!this.isUnseenFilter()&&this.isEmptyList()&&!this.isError()&&!this.isLoading()}),this),this.visibleInfoMessageListError=r.computed((function(){return!this.isSearch()&&this.isError()}),this),this.visibleInfoSearchError=r.computed((function(){return this.isSearch()&&this.isError()}),this),this.visibleInfoUnseenFilterList=r.computed((function(){return this.isUnseenFilter()&&(this.isLoading()||!this.isEmptyList())}),this),this.visibleInfoUnseenFilterEmpty=r.computed((function(){return this.isUnseenFilter()&&this.isEmptyList()&&!this.isError()&&!this.isLoading()}),this),this.allowClearSearch=r.observable(!0),this.searchText=r.computed((function(){const e={SEARCH:this.calculateSearchStringForDescription(),FOLDER:T.getCurrentFolder()?h.encodeHtml(T.getCurrentFolder().displayName()):""};return this.allowClearSearch(!0),this.searchFoldersMode()===Enums.SearchFoldersMode.Sub?T.oUnifiedInbox.selected()?h.i18n("MAILWEBCLIENT/INFO_SEARCH_UNIFIED_SUBFOLDERS_RESULT",e):"folders:sub"===o.trim(this.search())?h.i18n("MAILWEBCLIENT/INFO_MESSAGES_FROM_SUBFOLDERS",e):h.i18n("MAILWEBCLIENT/INFO_SEARCH_SUBFOLDERS_RESULT",e):this.searchFoldersMode()===Enums.SearchFoldersMode.All?T.oUnifiedInbox.selected()?h.i18n("MAILWEBCLIENT/INFO_SEARCH_UNIFIED_ALL_FOLDERS_RESULT",e):"folders:all"===o.trim(this.search())?(this.isStarredFolder()&&this.allowClearSearch(!1),h.i18n("MAILWEBCLIENT/INFO_MESSAGES_FROM_ALL_FOLDERS",e)):h.i18n("MAILWEBCLIENT/INFO_SEARCH_ALL_FOLDERS_RESULT",e):h.i18n("MAILWEBCLIENT/INFO_SEARCH_RESULT",e)}),this),this.unseenFilterText=r.computed((function(){return""===this.search()?h.i18n("MAILWEBCLIENT/INFO_UNREAD_MESSAGES",{FOLDER:T.getCurrentFolder()?h.encodeHtml(T.getCurrentFolder().displayName()):""}):h.i18n("MAILWEBCLIENT/INFO_UNREAD_MESSAGES_SEARCH_RESULT",{SEARCH:this.calculateSearchStringForDescription(),FOLDER:T.getCurrentFolder()?h.encodeHtml(T.getCurrentFolder().displayName()):""})}),this),this.unseenFilterEmptyText=r.computed((function(){return""===this.search()?h.i18n("MAILWEBCLIENT/INFO_NO_UNREAD_MESSAGES"):h.i18n("MAILWEBCLIENT/INFO_NO_UNREAD_MESSAGES_FOUND")}),this),this.isEnableGroupOperations=r.observable(!1).extend({throttle:250}),this.selector=new g(this.collection,i.bind(this.routeForMessage,this),i.bind(this.onDeletePress,this),i.bind(this.onMessageDblClick,this),i.bind(this.onEnterPress,this),null,!1,!1,!1,!1,!1),this.checkedUids=r.computed((function(){var e=this.selector.listChecked(),t=i.map(e,(function(e){return e.longUid()})),s=T.getCurrentFolder(),o=s?s.getThreadCheckedUidsFromList(e):[];return i.union(t,o)}),this),this.checkedOrSelectedUids=r.computed((function(){var e=this.checkedUids();return 0===e.length&&T.currentMessage()&&i.isFunction(T.currentMessage().deleted)&&!T.currentMessage().deleted()&&(e=[T.currentMessage().longUid()]),e}),this),r.computed((function(){this.isEnableGroupOperations(0<this.selector.listCheckedOrSelected().length)}),this),this.checkAll=this.selector.koCheckAll(),this.checkAllIncomplite=this.selector.koCheckAllIncomplete(),this.pageSwitcherLocked=r.observable(!1),this.oPageSwitcher=new v(0,L.MailsPerPage),this.oPageSwitcher.currentPage.subscribe((function(e){var t=T.getCurrentFolderFullname(),s=!d.isMobile()&&this.currentMessage()?this.currentMessage().longUid():"",i=this.search();this.pageSwitcherLocked()||this.changeRoutingForMessageList(t,e,s,i,this.filters(),this.sortBy(),this.sortOrder())}),this),this.currentPage=r.observable(0),p.firefox||p.ie?this.listChangedThrottle=r.observable(!1).extend({throttle:10}):this.listChangedThrottle=r.observable(!1),this.firstCompleteCollection=r.observable(!0),this.collection.subscribe((function(){this.collection().length>0&&(c.isNonEmptyArray(this.aRouteParams)?(this.onRoute(this.aRouteParams),this.aRouteParams=[]):this.firstCompleteCollection(!1))}),this),this.listChanged=r.computed((function(){return[this.firstCompleteCollection(),T.currentAccountId(),this.folderFullName(),this.filters(),this.search(),this.oPageSwitcher.currentPage()]}),this),this.listChanged.subscribe((function(){this.listChangedThrottle(!this.listChangedThrottle())}),this),this.bAdvancedSearch=r.observable(!1),this.searchAttachmentsCheckbox=r.observable(!1),this.searchAttachments=r.observable(""),this.searchAttachments.subscribe((function(e){this.searchAttachmentsCheckbox(!!e)}),this),this.searchAttachmentsFocus=r.observable(!1),this.searchFromFocus=r.observable(!1),this.searchSubjectFocus=r.observable(!1),this.searchToFocus=r.observable(!1),this.searchTextFocus=r.observable(!1),this.searchTrigger=r.observable(null),this.searchDateStartFocus=r.observable(!1),this.searchDateEndFocus=r.observable(!1),this.searchDateStartDom=r.observable(null),this.searchDateStartTimestamp=r.observable(""),this.searchDateStart=r.observable(""),this.searchDateStart.subscribe((e=>{e&&this.searchDateStartTimestamp(n(e,a.getDateFormatForMoment(E.dateFormat())).toDate().getTime()/1e3)})),this.searchDateEndDom=r.observable(null),this.searchDateEndTimestamp=r.observable(""),this.searchDateEnd=r.observable(""),this.searchDateEnd.subscribe((e=>{e&&this.searchDateEndTimestamp(n(e,a.getDateFormatForMoment(E.dateFormat())).toDate().getTime()/1e3)})),this.dateFormatDatePicker=r.computed((()=>w.getDateFormatForDatePicker(E.dateFormat()))),E.dateFormat.subscribe((()=>{const e=new A,t=new A;this.searchDateStartTimestamp()&&(e.parse(this.searchDateStartTimestamp()),this.searchDateStart(e.getShortDate())),this.searchDateEndTimestamp()&&(t.parse(this.searchDateEndTimestamp()),this.searchDateEnd(t.getShortDate())),this.createDatePickerObject(this.searchDateStartDom(),this.searchDateStart),this.createDatePickerObject(this.searchDateEndDom(),this.searchDateEnd),this.searchHighlightedInputFormatted(C.formattedDateSearchHighlightedInput(this.searchHighlightedInput()))})),this.attachmentsPlaceholder=r.computed((function(){return h.i18n("MAILWEBCLIENT/LABEL_HAS_ATTACHMENTS")}),this),this.customMessageItemViewTemplate=r.observable(""),d.broadcastEvent("MailWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this,MailCache:T})}s("okSt"),R.prototype.ViewTemplate="MailWebclient_MessagesView",R.prototype.ViewConstructorName="CMessageListView",R.prototype.addNewAccount=function(){d.Api.createMailAccount(M.getEmail())},R.prototype.createDatePickerObject=function(e,t){o(e).datepicker("destroy"),o(e).datepicker({showOtherMonths:!0,selectOtherMonths:!0,monthNames:l.getMonthNamesArray(),dayNamesMin:h.i18n("COREWEBCLIENT/LIST_DAY_NAMES_MIN").split(" "),nextText:"",prevText:"",firstDay:c.pInt(b.run("CalendarWebclient","getWeekStartsOn")),showOn:"focus",dateFormat:this.dateFormatDatePicker(),onClose:function(e){r.isObservable(t)&&t(e)}}),o(e).mousedown((function(){o("#ui-datepicker-div").toggle()}))},R.prototype.changeRoutingForMessageList=function(e,t,s,i,o,r,n){f.setHash(I.getMailbox(e,t,s,i,o,r,n))&&i.length>0&&this.search()===i&&this.listChangedThrottle(!this.listChangedThrottle())},R.prototype.onEnterPress=function(e){e.threadNextLoadingVisible()?e.loadNextMessages():e.openThread()},R.prototype.onMessageDblClick=function(e){if(!this.isSavingDraft(e)){var t=this.folderList().getFolderByFullName(e.folder()),s={Message:e,Cancel:!1};d.broadcastEvent("MailWebclient::MessageDblClick::before",s),s.Cancel||(t.type()===Enums.FolderTypes.Drafts||T.isTemplateFolder(e.folder())?y.composeMessageFromDrafts(e.accountId(),e.folder(),e.longUid()):this.openMessageInNewWindowBound(e))}},R.prototype.onFolderListSubscribe=function(){this.setCurrentFolder(),this.requestMessageList()},R.prototype.onShow=function(e){this.selector.useKeyboardKeys(!0),this.oPageSwitcher.show(),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!0)},R.prototype.onHide=function(e){this.selector.useKeyboardKeys(!1),this.oPageSwitcher.hide(),this.oJua&&this.oJua.setDragAndDropEnabledStatus(!1)},R.prototype.onRoute=function(e){var t=I.parseMailbox(e),s=this.folderFullName()||this.folderList().inboxFolderFullName(),i=function(e,t){if(e===Enums.FolderFilter.Flagged&&L.AllowChangeStarredMessagesSource)if(/(^|\s)folders:all(\s|$)/.test(t)){if(L.StarredMessagesSource===Enums.StarredMessagesSource.InboxOnly)return t.replace("folders:all","")}else if(L.StarredMessagesSource===Enums.StarredMessagesSource.AllFolders)return`${t} folders:all`;return t}(t.Filters,t.Search),o=this.currentPage()!==t.Page||s!==t.Folder||this.filters()!==t.Filters||t.Filters===Enums.FolderFilter.Unseen&&T.waitForUnseenMessages()||this.search()!==i||this.sSortBy!==t.SortBy||this.iSortOrder!==t.SortOrder,r=L.MailsPerPage!==this.oPageSwitcher.perPage();this.pageSwitcherLocked(!0),s!==t.Folder||this.search()!==i||this.filters()!==t.Filters?this.oPageSwitcher.clear():this.oPageSwitcher.setPage(t.Page,L.MailsPerPage),this.pageSwitcherLocked(!1),i!==t.Search?f.replaceHash(I.getMailbox(t.Folder,this.oPageSwitcher.currentPage(),t.Uid,i,t.Filters)):t.Page!==this.oPageSwitcher.currentPage()&&(0===this.folderList().iAccountId?this.aRouteParams=e:f.replaceHash(I.getMailbox(t.Folder,this.oPageSwitcher.currentPage(),t.Uid,i,t.Filters))),this.currentPage(this.oPageSwitcher.currentPage()),this.folderFullName(t.Folder),this.filters(t.Filters),this.search(i),this.searchInput(this.search()),this.setSearchFolderMode(),this.searchSpan.notifySubscribers(),this.sSortBy=t.SortBy,this.iSortOrder=t.SortOrder,this.sortBy(t.SortBy),this.sortOrder(t.SortOrder),this.setCurrentFolder(),(o||r||0===this.collection().length)&&(t.Filters===Enums.FolderFilter.Unseen&&T.waitForUnseenMessages(!0),this.requestMessageList(),this.messageListParamsChanged(!0)),this.highlightTrigger.notifySubscribers(!0)},R.prototype.setSearchFolderMode=function(){/(^|\s)folders:all(\s|$)/.test(this.search())?this.searchFoldersMode(Enums.SearchFoldersMode.All):/(^|\s)folders:sub(\s|$)/.test(this.search())?this.searchFoldersMode(Enums.SearchFoldersMode.Sub):this.searchFoldersMode(Enums.SearchFoldersMode.Current)},R.prototype.setCurrentFolder=function(){T.setCurrentFolder(this.folderFullName(),this.filters()),this.folderType(T.getCurrentFolderType())},R.prototype.requestMessageList=function(){var e=T.getCurrentFolderFullname(),t=this.oPageSwitcher.currentPage();e.length>0?T.changeCurrentMessageList(e,t,this.search(),this.filters(),this.sortBy(),this.sortOrder()):T.checkCurrentFolderList()},R.prototype.calculateSearchStringFromAdvancedForm=function(){var e=this.searchInputFrom(),t=this.searchInputTo(),s=this.searchInputSubject(),i=this.searchInputText(),r=this.searchAttachmentsCheckbox(),[n,a]=C.changeDateStartAndDateEndformatForSend(this.searchDateStart(),this.searchDateEnd()),l=[],h=function(e){return(-1<(e=o.trim(e).replace(/"/g,'\\"')).indexOf(" ")||-1<e.indexOf('"'))&&(e='"'+e+'"'),e};return""!==e&&l.push("from:"+h(e)),""!==t&&l.push("to:"+h(t)),""!==s&&l.push("subject:"+h(s)),""!==i&&l.push("text:"+h(i)),r&&l.push("has:attachments"),""===n&&""===a||l.push("date:"+h(n)+"/"+h(a)),this.selectedSearchFoldersMode()!==Enums.SearchFoldersMode.Sub&&this.selectedSearchFoldersMode()!==Enums.SearchFoldersMode.All||l.push("folders:"+this.selectedSearchFoldersMode()),l.join(" ")},R.prototype.manualChangeSearchString=function(e){const t=["date:","subject:","text:","from:","to:","has:","folders:"],s=new RegExp("\\s("+t.join("|")+")","g"),i=(" "+e).split(s);let o="";if(i.length>1)for(let e=1;e<i.length;e+=2){const s=i[e],r=i[e+1];if(s===t[0]){const[e,t]=r.split(" - "),[i,n]=C.changeDateStartAndDateEndformatForSend(e,t);(i||n)&&(o+=s+i+"/"+n+" ")}else o+=s+r+" "}else o=e;return o},R.prototype.onSearchClick=function(){var e=T.getCurrentFolderFullname(),t=this.searchInput();this.allowAdvancedSearch()&&this.bAdvancedSearch()?(t=this.calculateSearchStringFromAdvancedForm(),this.bAdvancedSearch(!1)):t=this.manualChangeSearchString(t),this.changeRoutingForMessageList(e,1,"",t,this.filters())},R.prototype.onRetryClick=function(){this.requestMessageList()},R.prototype.onClearSearchClick=function(){var e=T.getCurrentFolderFullname(),t=this.currentMessage()?this.currentMessage().longUid():"";this.clearAdvancedSearch(),this.changeRoutingForMessageList(e,1,t,"",this.filters(),this.sortBy(),this.sortOrder())},R.prototype.onClearFilterClick=function(){var e=T.getCurrentFolderFullname(),t=this.currentMessage()?this.currentMessage().longUid():"";this.clearAdvancedSearch(),this.changeRoutingForMessageList(e,1,t,"","",this.sortBy(),this.sortOrder())},R.prototype.onStopSearchClick=function(){this.onClearSearchClick()},R.prototype.isSavingDraft=function(e){return T.getCurrentFolder().type()===Enums.FolderTypes.Drafts&&e.longUid()===T.savingDraftUid()},R.prototype.routeForMessage=function(e){if(e&&e.longUid&&!this.isSavingDraft(e)){var t=T.getCurrentFolder(),s=T.getCurrentFolderFullname(),i=this.oPageSwitcher.currentPage(),o=e.longUid(),r=this.currentMessage()?this.currentMessage().longUid():"",n=this.search();""!==o&&o!==r&&(d.isMobile()&&t.type()===Enums.FolderTypes.Drafts?f.setHash(I.getComposeFromMessage("drafts",e.accountId(),e.folder(),e.longUid())):(this.changeRoutingForMessageList(s,i,o,n,this.filters(),this.sortBy(),this.sortOrder()),d.isMobile()&&T.currentMessage()&&o===T.currentMessage().longUid()&&T.currentMessage.valueHasMutated()))}},R.prototype.unbind=function(){this.selector.unbind()},R.prototype.onBind=function(e){var t=this,s=i.bind((function(e){e&&e.stopPropagation&&e.stopPropagation()}),this);o(".message_list",e).on("click",(function(){t.isFocused(!1)})).on("click",".message_sub_list .item .flag",(function(e){t.onFlagClick(r.dataFor(this)),e&&e.stopPropagation&&e.stopPropagation()})).on("dblclick",".message_sub_list .item .flag",s).on("click",".message_sub_list .item .thread-pin",s).on("dblclick",".message_sub_list .item .thread-pin",s),this.selector.initOnApplyBindings(".message_sub_list .item",".message_sub_list .item.selected",".message_sub_list .item .custom_checkbox",o(".message_list",e),o(".message_list_scroll.scroll-inner",e)),i.delay(i.bind((function(){this.createDatePickerObject(this.searchDateStartDom(),this.searchDateStart),this.createDatePickerObject(this.searchDateEndDom(),this.searchDateEnd)}),this),1e3),this.initUploader()},R.prototype.onFlagClick=function(e){this.isSavingDraft(e)||T.executeGroupOperation("SetMessageFlagged",[e.longUid()],"flagged",!e.flagged())},R.prototype.executeMarkAsRead=function(){T.executeGroupOperation("SetMessagesSeen",this.checkedOrSelectedUids(),"seen",!0)},R.prototype.executeMarkAsUnread=function(){T.executeGroupOperation("SetMessagesSeen",this.checkedOrSelectedUids(),"seen",!1)},R.prototype.executeMarkAllRead=function(){T.executeGroupOperation("SetAllMessagesSeen",[],"seen",!0)},R.prototype.executeMoveToFolder=function(e){var t=T.getFolderByFullName(T.currentAccountId(),e),s=this.checkedOrSelectedUids(),o=T.getUidsSeparatedByFolders(s);t&&i.each(o,(function(e){if(T.currentAccountId()===e.iAccountId){var s=T.getFolderByFullName(T.currentAccountId(),e.sFolder);s&&T.moveMessagesToFolder(s,t,e.aUids)}}))},R.prototype.executeCopyToFolder=function(e){var t=T.getFolderByFullName(T.currentAccountId(),e),s=this.checkedOrSelectedUids(),o=T.getUidsSeparatedByFolders(s);t&&i.each(o,(function(e){if(T.currentAccountId()===e.iAccountId){var s=T.getFolderByFullName(T.currentAccountId(),e.sFolder);s&&T.copyMessagesToFolder(s,t,e.aUids)}}))},R.prototype.onDeletePress=function(e){var t=i.map(e,(function(e){return e.longUid()}));t.length>0&&this.deleteMessages(t)},R.prototype.executeDelete=function(){this.deleteMessages(this.checkedOrSelectedUids())},R.prototype.deleteMessages=function(e){var t="",s=null;T.uidList().filters()!==Enums.FolderFilter.Unseen&&1===e.length&&T.currentMessage()&&e[0]===T.currentMessage().longUid()&&""===(t=T.prevMessageUid())&&(t=T.nextMessageUid()),e.length>0&&F.deleteMessages(e,function(){""!==t&&(s=i.find(this.collection(),(function(e){return e&&i.isFunction(e.longUid)&&(e.longUid()===t||e.uid()===t)})))&&this.routeForMessage(s)}.bind(this))},R.prototype.executeSpam=function(){var e=this.checkedOrSelectedUids(),t=T.getUidsSeparatedByFolders(e);i.each(t,(function(e){var t=T.oFolderListItems[e.iAccountId],s=t?t.spamFolder():null,i=t?t.getFolderByFullName(e.sFolder):null;i&&s&&i.fullName()!==s.fullName()&&T.moveMessagesToFolder(i,s,e.aUids)}))},R.prototype.executeNotSpam=function(){var e=T.getCurrentFolder(),t=this.folderList().inboxFolder(),s=this.checkedOrSelectedUids(),o=T.getUidsSeparatedByFolders(s);t&&e&&e.fullName()!==t.fullName()&&i.each(o,(function(s){e.iAccountId===s.iAccountId&&e.fullName()===s.sFolder&&T.moveMessagesToFolder(e,t,s.aUids)}))},R.prototype.executeSort=function(e){const t=this.sortBy();this.sortBy(e),t===e?this.sortOrder(this.sortOrder()===Enums.SortOrder.Asc?Enums.SortOrder.Desc:Enums.SortOrder.Asc):this.sortOrder(L.MessagesSortBy.DefaultSortOrder);const s=T.getCurrentFolderFullname(),i=this.oPageSwitcher.currentPage();this.changeRoutingForMessageList(s,i,"",this.search(),this.filters(),this.sortBy(),this.sortOrder())},R.prototype.clearAdvancedSearch=function(){this.searchInputFrom(""),this.searchInputTo(""),this.searchInputSubject(""),this.searchInputText(""),this.bAdvancedSearch(!1),this.searchAttachmentsCheckbox(!1),this.searchAttachments(""),this.searchDateStart(""),this.searchDateEnd(""),this.selectedSearchFoldersMode(this.isStarredInAllFolders()?"all":"")},R.prototype.onAdvancedSearchClick=function(){this.bAdvancedSearch(!this.bAdvancedSearch())},R.prototype.calculateSearchStringForDescription=function(){return h.encodeHtml(this.searchHighlightedInputFormatted().replace(/(^|\s)folders:(all|sub)(\s|$)/,""))},R.prototype.initUploader=function(){var e=this;this.uploaderArea()&&(this.oJua=new m({action:"?/Api/",name:"jua-uploader",queueSize:2,dragAndDropElement:this.uploaderArea(),disableAjaxUpload:!1,disableFolderDragAndDrop:!1,disableDragAndDrop:!1,hidden:i.extendOwn({Module:L.ServerModuleName,Method:"UploadMessage",Parameters:function(){return JSON.stringify({AccountID:T.currentAccountId(),Folder:e.folderFullName()})}},d.getCommonRequestParameters())}),this.oJua.on("onDrop",i.bind(this.onFileDrop,this)).on("onComplete",i.bind(this.onFileUploadComplete,this)).on("onBodyDragEnter",i.bind(this.bDragActive,this,!0)).on("onBodyDragLeave",i.bind(this.bDragActive,this,!1)))},R.prototype.onFileDrop=function(e){e&&e.File&&e.File.type&&0===e.File.type.indexOf("message/")||S.showError(h.i18n("MAILWEBCLIENT/ERROR_FILE_NOT_EML"))},R.prototype.onFileUploadComplete=function(e,t,s){t&&s&&!s.ErrorCode?T.executeCheckMail(!0):u.showErrorByCode(s||{},h.i18n("COREWEBCLIENT/ERROR_UPLOAD_FILE"))},R.prototype.selectFolderSearch=function(e){this.selectedSearchFoldersMode(e)},e.exports=R},DBk0:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("KC/L");function n(e,t,s,n,a){this.server=o.observable(""),this.server.focused=o.observable(!1),this.label=n,this.defaultPort=o.observable(e),this.defaultSslPort=o.observable(t),this.port=o.observable(e),this.port.focused=o.observable(!1),this.ssl=o.observable(!1),this.isEnabled=o.observable(!0),this.id=s,i.isFunction(a)&&a.focused.subscribe((function(){a.focused()||""!==this.server()||this.server(a())}),this),this.ssl.subscribe((function(){var e=r.pInt(this.port());this.ssl()?e===this.defaultPort()&&this.port(this.defaultSslPort()):e===this.defaultSslPort()&&this.port(this.defaultPort())}),this)}n.prototype.set=function(e,t,s){this.server(e),this.ssl(s),this.port(t)},n.prototype.clear=function(){this.server(""),this.ssl(!1),this.port(this.defaultPort())},n.prototype.getIntPort=function(){return r.pInt(this.port())},n.prototype.parentSave=function(e,t){e.focused&&e.focused(!1);var s=i.find(t,(function(e){return i.isFunction(e.save)}));s&&s.save()},e.exports=n},fSBA:(e,t,s)=>{"use strict";var i=s("p09A"),o=s("9kOp"),r=s("OfVV"),n=s("7xgn");function a(){this.defaultAccount=n.getDefault(),this.visible=i.observable(!!this.defaultAccount&&this.defaultAccount.oServer.bSetExternalAccessServers),this.externalAccessImapServer=i.observable(this.visible()?this.defaultAccount.oServer.sExternalAccessImapServer:""),this.externalAccessImapPort=i.observable(this.visible()?this.defaultAccount.oServer.iExternalAccessImapPort:143),this.externalAccessImapAlterPort=i.observable(this.visible()&&this.defaultAccount.oServer.iExternalAccessImapAlterPort>0?this.defaultAccount.oServer.iExternalAccessImapAlterPort:""),this.externalAccessImapUseSsl=i.observable(!!this.visible()&&this.defaultAccount.oServer.bExternalAccessImapUseSsl),this.externalAccessPop3Server=i.observable(this.visible()?this.defaultAccount.oServer.sExternalAccessPop3Server:""),this.externalAccessPop3Port=i.observable(this.visible()?this.defaultAccount.oServer.iExternalAccessPop3Port:110),this.externalAccessPop3AlterPort=i.observable(this.visible()&&this.defaultAccount.oServer.iExternalAccessPop3AlterPort>0?this.defaultAccount.oServer.iExternalAccessPop3AlterPort:""),this.externalAccessPop3UseSsl=i.observable(!!this.visible()&&this.defaultAccount.oServer.bExternalAccessImapUseSsl),this.externalAccessSmtpServer=i.observable(this.visible()?this.defaultAccount.oServer.sExternalAccessSmtpServer:""),this.externalAccessSmtpPort=i.observable(this.visible()?this.defaultAccount.oServer.iExternalAccessSmtpPort:25),this.externalAccessSmtpAlterPort=i.observable(this.visible()&&this.defaultAccount.oServer.iExternalAccessSmtpAlterPort>0?this.defaultAccount.oServer.iExternalAccessSmtpAlterPort:""),this.externalAccessSmtpUseSsl=i.observable(!!this.visible()&&this.defaultAccount.oServer.bExternalAccessSmtpUseSsl),this.credentialsHintText=o.mobileCredentialsHintText,this.bDemo=r.IsDemo}a.prototype.ViewTemplate="MailWebclient_DefaultAccountHostsSettingsView",e.exports=new a},Uzkn:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("oFXy"),a=s("C5H3"),l=s("7xgn"),h=s("F0Fd");function c(){a.call(this,r.i18n("MAILWEBCLIENT/ACTION_SHOW_MAIL")),this.unseenCount=h.newMessagesCount,this.inactiveTitle=o.computed((function(){return r.i18n("MAILWEBCLIENT/HEADING_UNREAD_MESSAGES_BROWSER_TAB_PLURAL",{COUNT:this.unseenCount()},null,this.unseenCount())+" - "+l.getEmail()}),this),this.accounts=o.computed((function(){return i.map(l.collection(),(function(e){return{bCurrent:e.isCurrent(),sText:n.UserLoginPartInAccountDropdown?e.email().split("@")[0]:e.email(),changeAccount:e.changeAccount.bind(e)}}))}),this),n.ShowEmailAsTabName&&(this.linkText=o.computed((function(){var e=i.find(this.accounts(),(function(e){return e.bCurrent}));return e?e.sText:r.i18n("MAILWEBCLIENT/HEADING_BROWSER_TAB")}),this)),this.mainHref=o.computed((function(){return this.isCurrent()?"javascript: void(0);":this.hash()}),this)}i.extendOwn(c.prototype,a.prototype),c.prototype.ViewTemplate="MailWebclient_HeaderItemView";var u=new c;u.allowChangeTitle(!0),e.exports=u},kb14:(e,t,s)=>{"use strict";const i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("Tt1R"),h=s("REt5"),c=s("9kOp"),u=s("TdEd"),d=s("fDmo"),p=s("W66n"),m=s("HCAJ"),g=s("OfVV"),b=s("mGms"),f=s("doeu"),S=s("B5X4"),E=s("CPab"),A=s("WOsA"),v=s("F0/K"),y=s("7xgn"),I=s("QaEg"),F=s("F0Fd"),C=s("cL06"),M=s("ixCM"),T=s("oFXy"),L=s("TGY0"),w=c.isNewTab()&&window.opener&&window.opener.MainTabMailMethods;function R(){f.call(this,"MailWebclient"),this.bNewTab=c.isNewTab(),this.isLoading=r.observable(!1),this.bAllowSearchMessagesBySubject=T.AllowSearchMessagesBySubject,F.folderList.subscribe(this.onFolderListSubscribe,this),this.messages=F.messages,this.messages.subscribe(this.onMessagesSubscribe,this),this.currentMessage=F.currentMessage,this.currentMessage.subscribe(this.onCurrentMessageSubscribe,this),g.timeFormat.subscribe(this.onCurrentMessageSubscribe,this),g.dateFormat.subscribe(this.onCurrentMessageSubscribe,this),this.displayedMessageUid=r.observable(""),this.browserTitle=r.computed((function(){var e=this.currentMessage(),t=e?e.subject():"";return(t?t+" - ":"")+y.getEmail()+" - "+n.i18n("MAILWEBCLIENT/HEADING_MESSAGE_BROWSER_TAB")}),this),this.isCurrentMessage=r.computed((function(){return!!this.currentMessage()}),this),this.isCurrentMessageLoaded=r.computed((function(){return this.isCurrentMessage()&&!this.isLoading()}),this),this.visibleNoMessageSelectedText=r.computed((function(){return this.messages().length>0&&!this.isCurrentMessage()}),this),this.prevMessageUid=F.prevMessageUid,this.nextMessageUid=F.nextMessageUid,this.isEnablePrevMessage=r.computed((function(){return c.isNewTab()&&a.isNonEmptyString(this.prevMessageUid())}),this),this.isEnableNextMessage=r.computed((function(){return c.isNewTab()&&a.isNonEmptyString(this.nextMessageUid())}),this),this.isEnableDelete=this.isCurrentMessage,this.isEnableReply=this.isCurrentMessageLoaded,this.isEnableReplyAll=this.isCurrentMessageLoaded,this.isEnableResend=this.isCurrentMessageLoaded,this.isEnableForward=this.isCurrentMessageLoaded,this.isEnablePrint=this.isCurrentMessageLoaded,this.isEnableSave=function(){return this.isCurrentMessage()&&""!==this.currentMessage().sDownloadAsEmlUrl},this.deleteCommand=h.createCommand(this,this.executeDeleteMessage,this.isEnableDelete),this.prevMessageCommand=h.createCommand(this,this.executePrevMessage,this.isEnablePrevMessage),this.nextMessageCommand=h.createCommand(this,this.executeNextMessage,this.isEnableNextMessage),this.replyCommand=h.createCommand(this,this.executeReply,this.isEnableReply),this.replyAllCommand=h.createCommand(this,this.executeReplyAll,this.isEnableReplyAll),this.resendCommand=h.createCommand(this,this.executeResend,this.isEnableResend),this.forwardCommand=h.createCommand(this,this.executeForward,this.isEnableForward),this.printCommand=h.createCommand(this,this.executePrint,this.isEnablePrint),this.saveCommand=h.createCommand(this,this.executeSave,this.isEnableSave),this.forwardAsAttachment=h.createCommand(this,this.executeForwardAsAttachment,this.isCurrentMessageLoaded),this.messageToolbarControllers=r.observableArray([]),this.registerController(M,"OnMessageToolbar"),this.moreCommand=h.createCommand(this,null,this.isCurrentMessageLoaded),this.moreSectionCommands=r.observableArray([]),c.broadcastEvent("MailWebclient::AddMoreSectionCommand",i.bind((function(e){var t=i.extend({Text:"",CssClass:"",Handler:function(){},Visible:!0},e);t.Command=h.createCommand(this,t.Handler,this.isCurrentMessageLoaded),this.moreSectionCommands.push(t)}),this)),this.oUnsubscribeButtonView=s("nWzW"),this.visiblePicturesControl=r.observable(!1),this.visibleShowPicturesLink=r.observable(!1),this.visibleConfirmationControl=r.computed((function(){return this.currentMessage()&&""!==this.currentMessage().readingConfirmationAddressee()&&this.currentMessage()&&this.currentMessage().readingConfirmationAddressee()!==y.getEmail()}),this),this.isCurrentNotDraftOrSent=r.computed((function(){var e=F.getCurrentFolder();return e&&e.fullName().length>0&&e.type()!==Enums.FolderTypes.Drafts&&e.type()!==Enums.FolderTypes.Sent}),this),this.isCurrentSentFolder=r.computed((function(){var e=F.getCurrentFolder();return!!e&&e.fullName().length>0&&e.type()===Enums.FolderTypes.Sent}),this),this.isCurrentNotDraftFolder=r.computed((function(){var e=F.getCurrentFolder();return!!e&&e.fullName().length>0&&e.type()!==Enums.FolderTypes.Drafts}),this),this.isCurrentTemplateFolder=r.computed((function(){return F.isTemplateFolder(F.getCurrentFolderFullname())}),this),this.topControllers=r.observableArray(),this.bodyControllers=r.observableArray(),this.bottomControllers=r.observableArray(),this.controllers=r.computed((function(){return i.union(this.topControllers(),this.bodyControllers(),this.bottomControllers(),this.messageToolbarControllers())}),this),this.disableAllSendTools=r.computed((function(){var e=!1;return i.each(this.controllers(),(function(t){i.isFunction(t.disableAllSendTools)&&t.disableAllSendTools()&&(e=!0)})),e}),this),this.isVisibleReplyTool=r.computed((function(){return!this.disableAllSendTools()&&this.isCurrentNotDraftOrSent()&&!this.isCurrentTemplateFolder()}),this),this.isVisibleResendTool=r.computed((function(){return!this.disableAllSendTools()&&this.isCurrentSentFolder()&&!this.isCurrentTemplateFolder()}),this),this.isVisibleForwardTool=r.computed((function(){return!this.disableAllSendTools()&&this.isCurrentNotDraftFolder()&&!this.isCurrentTemplateFolder()}),this),this.accountId=r.observable(0),this.folder=r.observable(""),this.uid=r.observable(""),this.subject=r.observable(""),this.emptySubject=r.computed((function(){return""===o.trim(this.subject())}),this),this.subjectForDisplay=r.computed((function(){return this.emptySubject()?n.i18n("MAILWEBCLIENT/LABEL_NO_SUBJECT"):this.subject()}),this),this.importance=r.observable(Enums.Importance.Normal),this.oFromAddr=r.observable(null),this.from=r.observable(""),this.fromEmail=r.observable(""),this.fullFrom=r.observable(""),this.to=r.observable(""),this.aToAddr=r.observableArray([]),this.cc=r.observable(""),this.aCcAddr=r.observableArray([]),this.bcc=r.observable(""),this.aBccAddr=r.observableArray([]),this.allRecipients=r.observableArray([]),this.currentAccountEmail=r.observable(),this.sMeSender=T.UseMeRecipientForMessages?n.i18n("MAILWEBCLIENT/LABEL_ME_SENDER"):null,this.sMeRecipient=T.UseMeRecipientForMessages?n.i18n("MAILWEBCLIENT/LABEL_ME_RECIPIENT"):null,this.fullDate=r.observable(""),this.midDate=r.observable(""),this.textBody=r.observable(""),this.textBodyForNewWindow=r.observable(""),this.domTextBody=r.observable(null),this.rtlMessage=r.observable(!1),this.contentHasFocus=r.observable(!1),c.broadcastEvent("MailWebclient::RegisterMessagePaneController",i.bind((function(e,t){this.registerController(e,t)}),this)),this.fakeHeader=r.computed((function(){var e=!!i.find(this.topControllers(),(function(e){return!!e.visible&&e.visible()}));return!(this.visiblePicturesControl()||this.visibleConfirmationControl()||e)}),this),this.sAttachmentsSwitcherViewTemplate=c.isMobile()?"MailWebclient_Message_AttachmentsSwitcherView":"",this.sQuickReplyViewTemplate=c.isMobile()||!T.AllowQuickReply?"":"MailWebclient_Message_QuickReplyView",this.attachments=r.observableArray([]),this.notInlineAttachments=r.computed((function(){return i.filter(this.attachments(),(function(e){return!e.linked()}))}),this),this.notInlineAttachmentsInString=r.computed((function(){return i.map(this.notInlineAttachments(),(function(e){return e.fileName()}),this).join(", ")}),this),this.allAttachmentsDownloadMethods=r.observableArray([]),this.visibleDownloadAllAttachmentsSeparately=r.computed((function(){return this.notInlineAttachments().length>1}),this),this.visibleExtendedDownload=r.computed((function(){return this.visibleDownloadAllAttachmentsSeparately()||this.allAttachmentsDownloadMethods().length>0}),this),c.broadcastEvent("MailWebclient::AddAllAttachmentsDownloadMethod",i.bind((function(e){this.allAttachmentsDownloadMethods.push(e)}),this)),this.detailsVisible=r.observable(m.getData("aurora_mail_is-message-details-visible")),this.detailsTooltip=r.computed((function(){return this.detailsVisible()?n.i18n("COREWEBCLIENT/ACTION_HIDE_DETAILS"):n.i18n("COREWEBCLIENT/ACTION_SHOW_DETAILS")}),this),this.hasNotInlineAttachments=r.computed((function(){return this.notInlineAttachments().length>0}),this),this.hasBodyText=r.computed((function(){return this.textBody().length>0}),this),this.visibleAddMenu=r.observable(!1),this.replyText=r.observable(""),this.replyTextFocus=r.observable(!1),this.replyPaneVisible=r.computed((function(){return this.currentMessage()&&this.currentMessage().completelyFilled()}),this),this.replySendingStarted=r.observable(!1),this.replySavingStarted=r.observable(!1),this.replyAutoSavingStarted=r.observable(!1),this.requiresPostponedSending=r.observable(!1),this.replyAutoSavingStarted.subscribe((function(){!this.replyAutoSavingStarted()&&this.requiresPostponedSending()&&(v.sendPostponedMail(this.replyDraftUid()),this.requiresPostponedSending(!1))}),this),this.hasReplyAllCcAddrs=r.observable(!1),this.placeholderText=r.computed((function(){return this.hasReplyAllCcAddrs()?n.i18n("MAILWEBCLIENT/LABEL_QUICK_REPLY_ALL"):n.i18n("MAILWEBCLIENT/LABEL_QUICK_REPLY")}),this),this.sendButtonText=r.computed((function(){return this.hasReplyAllCcAddrs()?n.i18n("MAILWEBCLIENT/ACTION_SEND_ALL"):n.i18n("MAILWEBCLIENT/ACTION_SEND")}),this),r.computed((function(){(!this.replyTextFocus()||this.replyAutoSavingStarted()||this.replySavingStarted()||this.replySendingStarted())&&this.stopAutosaveTimer(),!this.replyTextFocus()||this.replyAutoSavingStarted()||this.replySavingStarted()||this.replySendingStarted()||this.startAutosaveTimer()}),this),this.saveButtonText=r.computed((function(){return this.replyAutoSavingStarted()?n.i18n("MAILWEBCLIENT/ACTION_SAVE_IN_PROGRESS"):n.i18n("MAILWEBCLIENT/ACTION_SAVE")}),this),this.replyDraftUid=r.observable(""),this.replyLoadingText=r.computed((function(){return this.replySendingStarted()?n.i18n("COREWEBCLIENT/INFO_SENDING"):this.replySavingStarted()?n.i18n("MAILWEBCLIENT/INFO_SAVING"):""}),this),this.isEnableSendQuickReply=r.computed((function(){return this.isCurrentMessageLoaded()&&""!==this.replyText()&&!this.replySendingStarted()}),this),this.isEnableSaveQuickReply=r.computed((function(){return this.isEnableSendQuickReply()&&!this.replySavingStarted()&&!this.replyAutoSavingStarted()}),this),this.saveQuickReplyCommand=h.createCommand(this,this.executeSaveQuickReply,this.isEnableSaveQuickReply),this.sendQuickReplyCommand=h.createCommand(this,this.executeSendQuickReply,this.isEnableSendQuickReply),this.domMessageHeader=r.observable(null),this.domQuickReply=r.observable(null),this.domMessageForPrint=r.observable(null),this.replyTextFocusThrottled=r.observable(!1).extend({throttle:50}),this.replyTextFocus.subscribe((function(){this.replyTextFocusThrottled(this.replyTextFocus())}),this),this.isQuickReplyActive=r.computed((function(){return this.replyText().length>0||this.replyTextFocusThrottled()}),this),this.visibleAttachments=r.observable(!1),this.showMessage=function(){this.visibleAttachments(!1)},this.showAttachments=function(){this.visibleAttachments(!0)},this.sDefaultFontName=T.DefaultFontName,d.registerDayOfMonthFunction(i.bind(this.updateMomentDate,this)),c.broadcastEvent("MailWebclient::ConstructView::after",{Name:"CMessagePaneView",View:this})}i.extendOwn(R.prototype,f.prototype),R.prototype.ViewTemplate=c.isNewTab()?"MailWebclient_MessagePaneScreenView":"MailWebclient_MessagePaneView",R.prototype.ViewConstructorName="CMessagePaneView",R.prototype.resizeDblClick=function(e,t){""!==t.target.className&&t.target.className.search(/add_contact|icon|link|title|subject|link|date|from/)&&(h.calmEvent(t),h.removeSelection(),this.expandMessagePaneWidth&&this.expandMessagePaneWidth(!this.expandMessagePaneWidth()))},R.prototype.notifySender=function(){if(this.currentMessage()&&""!==this.currentMessage().readingConfirmationAddressee()){var e=n.i18n("MAILWEBCLIENT/LABEL_RETURN_RECEIPT_MAIL_TEXT",{EMAIL:y.getEmail(),SUBJECT:this.subject()}).replace(/\\r\\n/g,"\n");I.send("SendMessage",{To:this.currentMessage().readingConfirmationAddressee(),Subject:n.i18n("MAILWEBCLIENT/LABEL_RETURN_RECEIPT_MAIL_SUBJECT"),Text:e,ConfirmFolder:this.currentMessage().folder(),ConfirmUid:this.currentMessage().longUid()}),this.currentMessage().readingConfirmationAddressee("")}},R.prototype.onFolderListSubscribe=function(){c.isNewTab()&&this.onMessagesSubscribe()},R.prototype.onMessagesSubscribe=function(){!this.currentMessage()&&this.uid()&&this.uid().length>0&&F.setCurrentMessage(this.accountId(),this.folder(),this.uid())},R.prototype.passReplyDataToNewTab=function(e){this.currentMessage()&&this.currentMessage().longUid()===e&&""!==this.replyText()&&(C.passReplyData(e,{ReplyText:this.replyText(),ReplyDraftUid:this.replyDraftUid()}),this.replyText(""),this.replyDraftUid(""))},R.prototype.onCurrentMessageSubscribe=function(){var e=this.currentMessage(),t=e?y.getAccount(e.accountId()):null,s=null;if(w&&e?(s=w.getReplyData(e.longUid()))&&(this.replyText(s.ReplyText),this.replyDraftUid(s.ReplyDraftUid)):e&&e.longUid()===this.displayedMessageUid()||(this.replyText(""),this.replyDraftUid("")),e&&this.uid()===e.uid()){if(this.hasReplyAllCcAddrs(v.hasReplyAllCcAddrs(e)),this.subject(e.subject()),this.importance(e.importance()),this.from(e.oFrom.getDisplay()),this.fromEmail(e.oFrom.getFirstEmail()),this.fullFrom(e.oFrom.getFull()),e.oFrom.aCollection.length>0?this.oFromAddr(e.oFrom.aCollection[0]):this.oFromAddr(null),this.to(e.oTo.getFull()),this.aToAddr(e.oTo.aCollection),this.cc(e.oCc.getFull()),this.aCcAddr(e.oCc.aCollection),this.bcc(e.oBcc.getFull()),this.aBccAddr(e.oBcc.aCollection),this.currentAccountEmail(t.email()),this.allRecipients(i.uniq(i.union(this.aToAddr(),this.aCcAddr(),this.aBccAddr()))),this.midDate(e.oDateModel.getMidDate()),this.fullDate(e.oDateModel.getFullDate()),this.isLoading(""!==e.longUid()&&!e.completelyFilled()),this.setMessageBody(),T.DisableRtlRendering||this.rtlMessage(e.rtl()),c.isNewTab()){var r=[];i.each(e.attachments(),i.bind((function(e){var t=new L(e.iAccountId);t.copyProperties(e),r.push(t)}),this)),this.attachments(r)}else this.attachments(e.attachments());if(!e.completelyFilled()||e.truncated()){var n=e.completelyFilled()?e.truncated:e.completelyFilled;c.isNewTab()?e.completelyFilledNewTabSubscription=n.subscribe(this.onCurrentMessageSubscribe,this):e.completelyFilledSubscription=n.subscribe(this.onCurrentMessageSubscribe,this)}else e.completelyFilledSubscription?(e.completelyFilledSubscription.dispose(),e.completelyFilledSubscription=void 0):e.completelyFilledNewTabSubscription&&(e.completelyFilledNewTabSubscription.dispose(),e.completelyFilledNewTabSubscription=void 0)}else this.hasReplyAllCcAddrs(!1),this.isLoading(!1),o(this.domTextBody()).empty().data("displayed-message-uid",""),this.displayedMessageUid(""),this.rtlMessage(!1),this.attachments([]),this.visiblePicturesControl(!1),this.visibleShowPicturesLink(!1);this.doAfterPopulatingMessage()},R.prototype.updateMomentDate=function(){var e=this.currentMessage();e&&e.oDateModel&&(this.midDate(e.oDateModel.getMidDate()),this.fullDate(e.oDateModel.getFullDate()))},R.prototype.setMessageBody=function(){if(this.currentMessage()){var e=this.currentMessage(),t=e.text(),s=o(this.domTextBody()),i=null,r="",a=t.length,l=[];this.textBody(t),s.data("displayed-message-uid")===e.longUid()&&(l=this.getBlockquotesStatus()),s.empty(),e.isPlain()||a>5e6?(s.html(t),this.visiblePicturesControl(!1)):(r=(i=e.getDomText()).length>0?i.html():"",s.append(r),this.visiblePicturesControl(e.hasExternals()&&!e.isExternalsAlwaysShown()),this.visibleShowPicturesLink(!e.isExternalsShown()),n.htmlStartsWithBlockquote(r)||this.doHidingBlockquotes(l)),s.data("displayed-message-uid",e.longUid()),this.displayedMessageUid(e.longUid())}},R.prototype.getBlockquotesStatus=function(){var e=[];return o(o("blockquote",o(this.domTextBody())).get()).each((function(){var t=o(this);t.hasClass("blockquote_before_toggle")&&e.push(t.hasClass("collapsed"))})),e},R.prototype.doHidingBlockquotes=function(e){var t=0;o(o("blockquote",o(this.domTextBody())).get()).each((function(){var s=o(this),i=s.parents("blockquote"),r=o('<span class="blockquote_toggle"></span>').html(n.i18n("MAILWEBCLIENT/ACTION_SHOW_QUOTED_TEXT")),a=!0;0===i.length&&s.height()>120&&(s.addClass("blockquote_before_toggle").after(r).wrapInner('<div class="blockquote_content"></div>'),r.bind("click",(function(){a?(s.height("auto"),r.html(n.i18n("MAILWEBCLIENT/ACTION_HIDE_QUOTED_TEXT")),a=!1):(s.height(80),r.html(n.i18n("MAILWEBCLIENT/ACTION_SHOW_QUOTED_TEXT")),a=!0),s.toggleClass("collapsed",a)})),t<e.length&&(a=e[t],t++),s.height(a?80:"auto").toggleClass("collapsed",a))}))},R.prototype.onRoute=function(e){var t=E.parseMailbox(e),s=t.Folder,i=t.Uid,o=F.getMessageActualIdentifiers(F.currentAccountId(),s,i);y.changeCurrentAccountByHash(t.AccountHash),""!==this.replyText()&&this.uid()!==o.sUid&&this.saveReplyMessage(!1),this.accountId(o.iAccountId),this.uid(o.sUid),this.folder(o.sFolder),F.setCurrentMessage(o.iAccountId,o.sFolder,o.sUid),c.isNewTab&&F.setCurrentFolder(t.Folder,t.Filters),this.contentHasFocus(!0)},R.prototype.showPictures=function(){F.showExternalPictures(!1),this.visibleShowPicturesLink(!1),this.setMessageBody()},R.prototype.alwaysShowPictures=function(){var e=this.currentMessage()?this.currentMessage().oFrom.getFirstEmail():"";e.length>0&&I.send("SetEmailSafety",{Email:e}),F.showExternalPictures(!0),this.visiblePicturesControl(!1),this.setMessageBody()},R.prototype.openInNewWindow=function(){this.openMessageInNewWindowBound(this.currentMessage())},R.prototype.getReplyHtmlText=function(){return'<div style="font-family: '+this.sDefaultFontName+'; font-size: 16px">'+v.getHtmlFromText(this.replyText())+"</div>"},R.prototype.executeReplyOrForward=function(e){this.currentMessage()&&(v.setReplyData(this.getReplyHtmlText(),this.replyDraftUid()),this.replyText(""),this.replyDraftUid(""),S.composeMessageAsReplyOrForward(e,this.currentMessage().accountId(),this.currentMessage().folder(),this.currentMessage().longUid()))},R.prototype.executeDeleteMessage=function(){this.currentMessage()&&(w?w.deleteMessage(this.currentMessage().longUid(),(function(){window.close()})):c.isMobile()&&A.deleteMessages([this.currentMessage().longUid()],c))},R.prototype.executePrevMessage=function(){this.isEnablePrevMessage()&&p.setHash(E.getViewMessage(F.currentAccountId(),F.getCurrentFolderFullname(),this.prevMessageUid()))},R.prototype.executeNextMessage=function(){this.isEnableNextMessage()&&p.setHash(E.getViewMessage(F.currentAccountId(),F.getCurrentFolderFullname(),this.nextMessageUid()))},R.prototype.executeReply=function(){this.executeReplyOrForward(Enums.ReplyType.Reply)},R.prototype.executeReplyAll=function(){this.executeReplyOrForward(Enums.ReplyType.ReplyAll)},R.prototype.executeResend=function(){this.executeReplyOrForward(Enums.ReplyType.Resend)},R.prototype.executeForward=function(){this.executeReplyOrForward(Enums.ReplyType.Forward)},R.prototype.executePrint=function(){var e=this.currentMessage(),t=e?b.open("",this.subject()+"-print"):null,s="";e&&t&&(this.textBodyForNewWindow(e.getConvertedHtml(l.getAppPath(),!0)),s=o(this.domMessageForPrint()).html(),t.document.title=this.subject(),o(t.document.body).html(s),t.print())},R.prototype.executeSave=function(){this.isEnableSave()&&this.currentMessage()&&l.downloadByUrl(this.currentMessage().sDownloadAsEmlUrl,!0)},R.prototype.executeForwardAsAttachment=function(){this.currentMessage()&&S.composeMessageWithEml(this.currentMessage())},R.prototype.changeAddMenuVisibility=function(){var e=!this.visibleAddMenu();this.visibleAddMenu(e)},R.prototype.onSendOrSaveMessageResponse=function(e,t){var s=v.onSendOrSaveMessageResponse(e,t,this.requiresPostponedSending());switch(s.Method){case"SendMessage":this.replySendingStarted(!1),s.Result&&this.replyText("");break;case"SaveMessage":s.Result&&this.replyDraftUid(s.NewUid),this.replySavingStarted(!1),this.replyAutoSavingStarted(!1)}},R.prototype.executeSendQuickReply=function(){this.isEnableSendQuickReply()&&(this.replySendingStarted(!0),this.requiresPostponedSending(this.replyAutoSavingStarted()),v.sendReplyMessage("SendMessage",this.getReplyHtmlText(),this.replyDraftUid(),this.onSendOrSaveMessageResponse,this,this.requiresPostponedSending()),this.replyTextFocus(!1))},R.prototype.executeSaveQuickReply=function(){this.saveReplyMessage(!1)},R.prototype.saveReplyMessage=function(e){this.isEnableSaveQuickReply()&&(e?this.replyAutoSavingStarted(!0):this.replySavingStarted(!0),v.sendReplyMessage("SaveMessage",this.getReplyHtmlText(),this.replyDraftUid(),this.onSendOrSaveMessageResponse,this))},R.prototype.stopAutosaveTimer=function(){window.clearTimeout(this.autoSaveTimer)},R.prototype.startAutosaveTimer=function(){if(this.isEnableSaveQuickReply()){var e=i.bind(this.saveReplyMessage,this,!0);this.stopAutosaveTimer(),T.AllowAutosaveInDrafts&&(this.autoSaveTimer=window.setTimeout(e,1e3*T.AutoSaveIntervalSeconds))}},R.prototype.executeAllAttachmentsDownloadMethod=function(e){const t=this.currentMessage();if(t){const s=t.notInlineAttachments(),i=s.map((e=>e.hash()));e(t.accountId(),i,s)}},R.prototype.downloadAllAttachmentsSeparately=function(){this.currentMessage()&&this.currentMessage().downloadAllAttachmentsSeparately()},R.prototype.onShow=function(){this.bShown=!0},R.prototype.onHide=function(){this.bShown=!1,this.accountId(0),this.folder(""),this.uid(""),i.each(this.controllers(),i.bind((function(e){i.isFunction(e.onHide)&&e.onHide()}),this))},R.prototype.onBind=function(e){u.run("SessionTimeoutWeblient","registerFunction",[i.bind((function(){""!==this.replyText()&&this.saveReplyMessage(!1)}),this)]),this.$MailViewDom=i.isUndefined(e)?this.$viewDom:e,this.$MailViewDom.on("mousedown","a",(function(e){if(e&&3!==e.which){var t=o(this).attr("href");if(t&&"mailto:"===t.toString().toLowerCase().substr(0,7))return S.composeMessageToAddresses(t.toString()),!1}return!0})),c.isMobile()||this.hotKeysBind()},R.prototype.hotKeysBind=function(){o(document).on("keydown",o.proxy((function(e){const t=this.bShown&&e&&!(e.ctrlKey||e.metaKey)&&!e.shiftKey&&!h.isTextFieldFocused()&&this.isEnableReply();t&&e.keyCode===Enums.Key.q?(e.preventDefault(),this.replyTextFocus(!0)):t&&e.keyCode===Enums.Key.r&&(e.preventDefault(),this.executeReply())}),this))},R.prototype.showSourceHeaders=function(){var e=this.currentMessage(),t=e&&e.completelyFilled()?b.open("",this.subject()+"-headers"):null;t&&o(t.document.body).html("<pre>"+n.encodeHtml(e.sourceHeaders())+"</pre>")},R.prototype.switchDetailsVisibility=function(){this.detailsVisible(!this.detailsVisible()),m.setData("aurora_mail_is-message-details-visible",this.detailsVisible())},R.prototype.registerController=function(e,t){switch(t){case"OnMessageToolbar":this.messageToolbarControllers.push(e);break;case"BeforeMessageHeaders":this.topControllers.push(e);break;case"BeforeMessageBody":this.bodyControllers.push(e);break;case"AfterMessageBody":this.bottomControllers.push(e)}i.isFunction(e.assignMessagePaneExtInterface)&&e.assignMessagePaneExtInterface(this.getExtInterface())},R.prototype.getExtInterface=function(){return{changeText:i.bind((function(e){var t=this.currentMessage();t&&this.isCurrentMessageLoaded()&&(t.changeText(e),this.setMessageBody())}),this)}},R.prototype.doAfterPopulatingMessage=function(){var e=this.currentMessage(),t=e&&!this.isLoading()?{iAccountId:e.accountId(),sFolderFullName:e.folder(),sMessageUid:e.uid(),aToEmails:e.oTo.getEmails(),bPlain:e.isPlain(),sRawText:e.textRaw(),sText:e.text(),sAccountEmail:y.getEmail(e.accountId()),sFromEmail:e.oFrom.getFirstEmail(),iSensitivity:e.sensitivity(),aExtend:e.aExtend}:null;i.each(this.controllers(),i.bind((function(e){i.isFunction(e.doAfterPopulatingMessage)&&e.doAfterPopulatingMessage(t)}),this)),u.run("ContactsWebclient","applyContactsCards",[this.$MailViewDom.find("span.address")])},R.prototype.searchBySubject=function(){if(T.AllowSearchMessagesBySubject&&this.currentMessage()){var e=this.currentMessage().folder(),t=this.currentMessage().longUid(),s="",r=this.currentMessage().subject().split(":"),n=T.PrefixesToRemoveBeforeSearchMessagesBySubject,a=[];0===n.length?s=r:(i.each(r,(function(e){if(a.length>0)a.push(e);else{var t=!1,s=o.trim(e);i.each(n,(function(e){var i=new RegExp("^"+e+"(\\[\\d*\\]){0,1}$","i");t=t||i.test(s)})),t||a.push(e)}})),s=o.trim(a.join(":"))),p.setHash(E.getMailbox(e,1,t,s,""))}},e.exports=new R},nWzW:(e,t,s)=>{"use strict";const i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("KC/L"),a=s("/QeJ"),l=s("XeMN"),h=s("oUN1"),c=s("skxT"),u=s("CPab"),d=s("QaEg"),p=s("F0Fd");function m(){this.unsubscribeOneClick=o.observable(!1),this.unsubscribeUrl=o.observable(""),this.unsubscribeEmail=o.observable(""),this.allowUnsubscribe=o.observable(!1),o.computed((function(){const e=p.currentMessage();e&&e.completelyFilled()&&(this.unsubscribeOneClick(n.pBool(e.unsubscribe.OneClick)),this.unsubscribeUrl(n.pString(e.unsubscribe.Url)),this.unsubscribeEmail(n.pString(e.unsubscribe.Email)),this.allowUnsubscribe(this.unsubscribeOneClick()||""!==this.unsubscribeUrl()||""!==this.unsubscribeEmail()))}),this).extend({rateLimit:100})}m.prototype.ViewTemplate="MailWebclient_Message_UnsubscribeButtonView",m.prototype.unsubscribe=function(){const e=p.currentMessage();if(e)if(this.unsubscribeOneClick()){const t={AccountID:e.accountId(),Folder:e.folder(),Uid:e.uid()};d.send("Unsubscribe",t,this.onUnsubscribeResponse,this)}else this.unsubscribeEmail()?this.unsubscribeWithEmail():this.unsubscribeUrl()&&window.open(this.unsubscribeUrl(),"_blank")},m.prototype.onUnsubscribeResponse=function(e,t){e&&e.Result?c.showReport(r.i18n("MAILWEBCLIENT/REPORT_UNSUBSCRIBE_MESSAGE_SUCCESS")):a.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_UNSUBSCRIBE_MESSAGE_FAIL"))},m.prototype.unsubscribeWithEmail=function(){const e=u.parseToAddr(this.unsubscribeEmail()),t={RECIPIENT:i.compact([e.to,e.cc,e.bcc]).join(", "),SUBJECT:e.subject},s=e.subject?r.i18n("MAILWEBCLIENT/CONFIRM_UNSUBSCRIBE_WITH_EMAIL_AND_SUBJECT",t):r.i18n("MAILWEBCLIENT/CONFIRM_UNSUBSCRIBE_WITH_EMAIL",t),o=r.i18n("MAILWEBCLIENT/ACTION_SEND");h.showPopup(l,[s,t=>{t&&this.sendUnsubscribeEmail(e)},"",o])},m.prototype.sendUnsubscribeEmail=function(e){const t={To:e.to,Cc:e.cc,Bcc:e.bcc,Subject:e.subject,Text:e.body};d.send("SendMessage",t,this.onUnsubscribeResponse,this)},e.exports=new m},ixCM:(e,t,s)=>{"use strict";const i=s("p09A"),o=s("H20a"),r=s("REt5"),n=s("QaEg"),a=s("/QeJ"),l=s("skxT"),h=s("7xgn"),c=s("F0Fd");function u(){this.allowSpamButtons=i.observable(!1),this.isCurrentMessageLoaded=i.observable(!1),this.neverSpamCommand=r.createCommand(this,this.neverSpam,this.isCurrentMessageLoaded),this.alwaysSpamCommand=r.createCommand(this,this.alwaysSpam,this.isCurrentMessageLoaded)}u.prototype.ViewTemplate="MailWebclient_Message_SpamButtonsView",u.prototype.doAfterPopulatingMessage=function(e){const t=c.currentMessage(),s=t?h.getAccount(t.accountId()):h.getCurrent(),i=!!s&&s.enableAllowBlockLists(),o=c.isTemplateFolder(t&&t.folder());this.allowSpamButtons(i&&!o),this.isCurrentMessageLoaded(!!e)},u.prototype.neverSpam=function(){const e=c.currentMessage().oFrom.getFirstEmail(),t={AccountID:h.editedId(),Email:e};n.send("AddEmailToAllowList",t,(function(t){t&&t.Result?l.showReport(o.i18n("MAILWEBCLIENT/REPORT_ADD_EMAIL_TO_ALLOWLIST_SUCCESS",{EMAIL:e})):a.showErrorByCode(t,o.i18n("MAILWEBCLIENT/ERROR_ADD_EMAIL_TO_ALLOWLIST",{EMAIL:e}))}),this)},u.prototype.alwaysSpam=function(){var e=c.currentMessage().oFrom.getFirstEmail(),t={AccountID:h.editedId(),Email:e};n.send("AddEmailToBlockList",t,(function(t){t&&t.Result?l.showReport(o.i18n("MAILWEBCLIENT/REPORT_ADD_EMAIL_TO_BLOCKLIST_SUCCESS",{EMAIL:e})):a.showErrorByCode(t,o.i18n("MAILWEBCLIENT/ERROR_ADD_EMAIL_TO_BLOCKLIST",{EMAIL:e}))}),this)},e.exports=new u},exJb:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("KC/L"),a=s("/QeJ"),l=s("TdEd"),h=s("skxT"),c=l.run("SettingsWebclient","getAbstractSettingsFormViewClass"),u=s("7xgn"),d=s("QaEg");function p(){c.call(this,"MailWebclient"),this.spamScore=o.observable(""),this.allowList=o.observable(""),this.blockList=o.observable("")}i.extendOwn(p.prototype,c.prototype),p.prototype.ViewTemplate="MailWebclient_Settings_AccountAllowBlockListsSettingsFormView",p.prototype.getCurrentValues=function(){return[this.spamScore(),this.allowList(),this.blockList()]},p.prototype.onShow=function(){this.populate()},p.prototype.getParametersForSave=function(){return{AccountID:u.editedId(),SpamScore:n.pInt(this.spamScore()),AllowList:""!==this.allowList()?this.allowList().split("\n"):[],BlockList:""!==this.blockList()?this.blockList().split("\n"):[]}},p.prototype.save=function(){this.isSaving(!0),this.updateSavedState(),d.send("SetAccountSpamSettings",this.getParametersForSave(),this.onResponse,this)},p.prototype.onResponse=function(e,t){this.isSaving(!1),!1===e.Result?a.showErrorByCode(e,r.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED")):h.showReport(r.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))},p.prototype.populate=function(){var e=u.getEdited();e&&d.send("GetAccountSpamSettings",{AccountID:e.id()},this.onGetAllowBlockListsResponse,this),this.updateSavedState()},p.prototype.onGetAllowBlockListsResponse=function(e,t){var s=e&&e.Result;if(s){var i=n.pInt(s.SpamScore),o=n.pArray(s.AllowList),r=n.pArray(s.BlockList);this.spamScore(i),this.allowList(o.join("\n")),this.blockList(r.join("\n")),this.updateSavedState()}},e.exports=new p},JTYw:(e,t,s)=>{"use strict";var i=s("M4cL"),o=s("a7T2"),r=s("p09A"),n=s("sdEb"),a=s("injE"),l=s("H20a"),h=s("KC/L"),c=s("A3in"),u=s("REt5"),d=s("/QeJ"),p=s("TdEd"),m=s("skxT"),g=p.run("SettingsWebclient","getAbstractSettingsFormViewClass"),b=s("7xgn"),f=s("QaEg"),S=s("oFXy"),E=s("OfVV"),A=s("9BUb");function v(){g.call(this,S.ServerModuleName),this.enable=r.observable(!1),this.subject=r.observable(""),this.message=r.observable(""),this.scheduled=r.observable(!1),this.dateFormatMoment=r.computed((function(){return u.getDateFormatForMoment(E.dateFormat())}),this),this.startDateDom=r.observable(null),this.startTimestamp=r.observable(null),this.endDateDom=r.observable(null),this.endTimestamp=r.observable(null),this.startTimestamp.subscribe((function(e){const t=n.unix(e);this.startDateDom().datepicker("setDate",t.format(this.dateFormatMoment()));const s=this.endTimestamp()?n.unix(this.endTimestamp()):n();if(t.diff(s,"days")>=0&&this.endDateDom()){const e=t.add(6,"days");this.endTimestamp(e.unix())}}),this),this.endTimestamp.subscribe((function(e){const t=n.unix(e);if(this.endDateDom().datepicker("setDate",t.format(this.dateFormatMoment())),(this.startTimestamp()?n.unix(this.startTimestamp()):n()).diff(t,"days")>=0&&this.startDateDom()){const e=t.subtract(6,"days");this.startTimestamp(e.unix())}}),this),b.editedId.subscribe((function(){this.bShown&&this.populate()}),this),this.startDateDom.subscribe((function(e){this.startTimestamp()||this.startTimestamp(n().unix()),this.createDatePickerObject(e,this.startTimestamp)}),this),this.endDateDom.subscribe((function(e){this.endTimestamp()||this.endTimestamp(n().add(6,"days").unix()),this.createDatePickerObject(e,this.endTimestamp)}),this),this.allowScheduledAutoresponder=S.AllowScheduledAutoresponder}s("okSt"),o.extendOwn(v.prototype,g.prototype),v.prototype.ViewTemplate="MailWebclient_Settings_AccountAutoresponderSettingsFormView",v.prototype.getCurrentValues=function(){return[this.enable(),this.subject(),this.message(),this.scheduled(),this.startTimestamp(),this.endTimestamp()]},v.prototype.onShow=function(){this.populate()},v.prototype.revert=function(){this.populate()},v.prototype.getParametersForSave=function(){const e={AccountID:b.editedId(),Enable:this.enable(),Subject:this.subject(),Message:this.message(),Scheduled:this.scheduled()};return this.scheduled()&&(e.Start=this.startTimestamp(),e.End=this.endTimestamp()),e},v.prototype.applySavedValues=function(e){var t=b.getEdited().autoresponder();t&&(t.enable=e.Enable,t.subject=e.Subject,t.message=e.Message,t.scheduled=e.Scheduled,t.start=e.Start,t.end=e.End)},v.prototype.save=function(){this.isSaving(!0),this.updateSavedState(),f.send("UpdateAutoresponder",this.getParametersForSave(),this.onResponse,this)},v.prototype.onResponse=function(e,t){if(this.isSaving(!1),!1===e.Result)d.showErrorByCode(e,l.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"));else{var s=t.Parameters;this.applySavedValues(s),m.showReport(l.i18n("MAILWEBCLIENT/REPORT_AUTORESPONDER_UPDATE_SUCCESS"))}},v.prototype.populate=function(){const e=b.getEdited();if(e){const t=e.autoresponder();null!==t?(this.enable(t.enable),this.subject(t.subject),this.message(t.message),this.scheduled(t.scheduled),null!==t.start&&this.startTimestamp(t.start),null!==t.end&&this.endTimestamp(t.end)):f.send("GetAutoresponder",{AccountID:e.id()},this.onGetAutoresponderResponse,this)}this.updateSavedState()},v.prototype.onGetAutoresponderResponse=function(e,t){if(e&&e.Result){var s=t.Parameters,i=h.pInt(s.AccountID),o=b.getAccount(i),r=new A;o&&(r.parse(i,e.Result),o.autoresponder(r),i===b.editedId()&&this.populate())}},v.prototype.createDatePickerObject=function(e,t){i(e).datepicker({showOtherMonths:!0,selectOtherMonths:!0,monthNames:a.getMonthNamesArray(),dayNamesMin:l.i18n("COREWEBCLIENT/LIST_DAY_NAMES_MIN").split(" "),nextText:"",prevText:"",firstDay:h.pInt(p.run("CalendarWebclient","getWeekStartsOn")),showOn:"focus",dateFormat:c.getDateFormatForDatePicker(E.dateFormat()),onClose:e=>{r.isObservable(t)&&t(n(e,this.dateFormatMoment()).unix())}}),i(e).datepicker("setDate",n.unix(t()).format(this.dateFormatMoment())),i(e).on("mousedown",(function(){i("#ui-datepicker-div").toggle()}))},e.exports=new v},"4Jr3":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("KC/L"),a=s("/QeJ"),l=s("skxT"),h=s("TdEd").run("SettingsWebclient","getAbstractSettingsFormViewClass"),c=s("7xgn"),u=s("QaEg"),d=s("F0Fd"),p=s("oFXy"),m=s("a/2+"),g=s("uDMB");function b(){h.call(this,p.ServerModuleName),this.bShown=!1,this.foldersOptions=o.observableArray([]),d.editedFolderList.subscribe((function(){this.bShown&&this.populate()}),this),this.loading=o.observable(!0),this.collection=o.observableArray([]),this.fieldOptions=[{text:r.i18n("MAILWEBCLIENT/LABEL_FROM"),value:0},{text:r.i18n("MAILWEBCLIENT/LABEL_TO"),value:1},{text:r.i18n("MAILWEBCLIENT/LABEL_SUBJECT"),value:2}],this.conditionOptions=[{text:r.i18n("MAILWEBCLIENT/LABEL_CONTAINING"),value:0},{text:r.i18n("MAILWEBCLIENT/LABEL_EQUAL_TO"),value:1},{text:r.i18n("MAILWEBCLIENT/LABEL_NOT_CONTAINING"),value:2}],this.actionOptions=[{text:r.i18n("MAILWEBCLIENT/LABEL_MOVE_FILTER_ACTION"),value:3},{text:r.i18n("MAILWEBCLIENT/LABEL_REDIRECT_FILTER_ACTION"),value:7},{text:r.i18n("MAILWEBCLIENT/LABEL_DELETE_FILTER_ACTION"),value:1}],this.phaseArray=[""],i.each(r.i18n("MAILWEBCLIENT/INFO_FILTER").split(/,{0,1}\s/),(function(e){var t=this.phaseArray.length-1;"%"===e.substr(0,1)||"%"===this.phaseArray[t].substr(-1,1)?this.phaseArray.push(e):this.phaseArray[t]+=" "+e}),this),this.firstState=null}i.extendOwn(b.prototype,h.prototype),b.prototype.ViewTemplate="MailWebclient_Settings_AccountFiltersSettingsFormView",b.prototype.onShow=function(){this.populate()},b.prototype.onHide=function(){this.bShown=!1},b.prototype.populate=function(){var e=d.editedFolderList(),t=[];e.iAccountId===c.editedId()?(t=e.getOptions(r.i18n("MAILWEBCLIENT/LABEL_FOLDER_NOT_SELECTED"),!0,!0,!1,!0),this.foldersOptions(t),this.populateFilters()):(this.loading(!0),this.collection([]))},b.prototype.revert=function(){var e=c.getEdited();e&&null!==e.filters()?this.collection([...e.filters().collection()]):this.collection([]),this.updateSavedState()},b.prototype.commit=function(){i.each(this.collection(),(function(e){e.commit()}))},b.prototype.getCurrentValues=function(){return i.map(this.collection(),(function(e){return e.toString()}),this)},b.prototype.getParametersForSave=function(){var e=i.map(this.collection(),(function(e){return{Enable:e.enable()?"1":"0",Field:e.field(),Filter:e.filter(),Condition:e.condition(),Action:e.action(),FolderFullName:e.folder(),Email:e.email()}}));return{AccountID:c.editedId(),Filters:e}},b.prototype.save=function(){i.some(this.collection(),(function(e){return""===e.filter()||"3"===n.pString(e.action())&&""===e.folder()}))?l.showError(r.i18n("MAILWEBCLIENT/ERROR_FILTER_FIELDS_EMPTY")):(this.isSaving(!0),this.commit(),this.updateSavedState(),u.send("UpdateFilters",this.getParametersForSave(),this.onAccountSieveFiltersUpdateResponse,this))},b.prototype.populateFilters=function(){var e=c.getEdited();e&&(null!==e.filters()?(this.loading(!1),this.collection([...e.filters().collection()]),this.updateSavedState()):(this.loading(!0),this.collection([]),u.send("GetFilters",{AccountID:e.id()},this.onGetFiltersResponse,this)))},b.prototype.deleteFilter=function(e){this.collection.remove(e)},b.prototype.addFilter=function(){var e=new m(c.editedId());this.collection.push(e)},b.prototype.displayFilterPart=function(e,t){return t+("%FIELD%"===e?"Field":"%CONDITION%"===e?"Condition":"%STRING%"===e?"String":"%ACTION%"===e?"Action":"%FOLDER%"===e?"Folder":"%EMAIL%"===e?"Email":"%DEPENDED"===e.substr(0,9)?"DependedText":"Text")},b.prototype.getDependedText=function(e){return(e=n.pString(e))&&(e=e.replace(/%/g,"").split("=")[1]||""),e},b.prototype.getDependedField=function(e,t){return(e=n.pString(e))&&(e=(e=e.replace(/[=](.*)/g,"").split("-")[1]||"").toLowerCase()),!!t[e]&&t[e]()},b.prototype.onGetFiltersResponse=function(e,t){var s=t.Parameters,i=n.pInt(s.AccountID),o=c.getAccount(i),a=new g;this.loading(!1),e&&e.Result&&o?(a.parse(i,e.Result),o.filters(a),i===c.editedId()&&this.populateFilters()):l.showError(r.i18n("COREWEBCLIENT/ERROR_UNKNOWN"))},b.prototype.onAccountSieveFiltersUpdateResponse=function(e,t){this.isSaving(!1);const s=c.getEdited();e&&e.Result?(l.showReport(r.i18n("MAILWEBCLIENT/REPORT_FILTERS_UPDATE_SUCCESS")),s&&s.filters().collection([...this.collection()])):a.showErrorByCode(e,r.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},e.exports=new b},"DXx+":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("REt5"),a=s("/QeJ"),l=s("9kOp"),h=s("TdEd"),c=s("oUN1"),u=s("WBAn"),d=s("frS4"),p=h.run("ImportExportMailPlugin","getImportExportPopup"),m=s("7xgn"),g=s("QaEg"),b=s("F0Fd"),f=s("oFXy");function S(){this.bAllowTemplateFolders=f.AllowTemplateFolders,this.highlighted=o.observable(!1).extend({autoResetToFalse:500}),this.collection=o.observableArray(b.editedFolderList().collection()),this.oCollSubscription=b.editedFolderList().collection.subscribe((function(e){this.collection(e)}),this),this.totalMessageCount=o.observable(0),this.enableButtons=o.computed((function(){return b.editedFolderList().initialized()}),this),b.editedFolderList.subscribe((function(e){this.collection(e.collection()),this.setTotalMessageCount(),this.oCollSubscription.dispose(),this.oCollSubscription=e.collection.subscribe((function(e){this.collection(e)}),this)}),this),this.addNewFolderCommand=n.createCommand(this,this.addNewFolder,this.enableButtons),this.setSystemFoldersCommand=n.createCommand(this,this.setSystemFolders,this.enableButtons),this.showMovedWithMouseItem=o.computed((function(){return!l.isMobile()}),this),this.allowImportExport=o.observable(h.isModuleEnabled("ImportExportMailPlugin")),l.subscribeEvent("MailWebclient::AttemptDeleteNonemptyFolder",i.bind((function(){this.highlighted(!0)}),this)),this.manageFolderButtons=o.observableArray([]),l.broadcastEvent("MailWebclient::RegisterManageFolderButton",function(e){this.manageFolderButtons.push(i.extend({tooltip:e=>"",cssClasses:e=>"",handler:e=>{}},e))}.bind(this)),l.broadcastEvent("MailWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this}),this.afterMove=i.debounce(i.bind(this.folderListOrderUpdate,this),3e3)}s("66Za"),S.prototype.ViewTemplate="MailWebclient_Settings_AccountFoldersPaneView",S.prototype.ViewConstructorName="CAccountFoldersPaneView",S.prototype.folderListOrderUpdate=function(){var e=b.editedFolderList().repopulateLinedCollection(),t={AccountID:m.editedId(),FolderList:i.compact(i.map(e,(function(e){if(!e.bVirtual)return e.fullName()})))};g.send("UpdateFoldersOrder",t,(function(e){e.Result||(a.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_CHANGE_FOLDERS_ORDER")),b.getFolderList(m.editedId()))}),this)},S.prototype.hide=function(e){var t=m.editedId();i.delay((function(){b.getFolderList(t)}),3e3),i.isFunction(e)&&e()},S.prototype.show=function(){this.setTotalMessageCount()},S.prototype.setTotalMessageCount=function(){var e=b.editedFolderList();0===e.iAccountId?this.totalMessageCount(0):(this.totalMessageCount(e.getTotalMessageCount()),e.countsCompletelyFilled()||(e.countsCompletelyFilledSubscribtion&&(e.countsCompletelyFilledSubscribtion.dispose(),e.countsCompletelyFilledSubscribtion=null),e.countsCompletelyFilledSubscribtion=e.countsCompletelyFilled.subscribe((function(){e.countsCompletelyFilled()&&(this.totalMessageCount(e.getTotalMessageCount()),e.countsCompletelyFilledSubscribtion.dispose(),e.countsCompletelyFilledSubscribtion=null)}),this)))},S.prototype.addNewFolder=function(){c.showPopup(u)},S.prototype.setSystemFolders=function(){c.showPopup(d)},S.prototype.importExport=function(){this.allowImportExport()&&c.showPopup(p,[{}])},e.exports=new S},dFFs:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("kG5I"),n=s("H20a"),a=s("KC/L"),l=s("/QeJ"),h=s("TdEd"),c=s("skxT"),u=h.run("SettingsWebclient","getAbstractSettingsFormViewClass"),d=s("oUN1"),p=s("hT1I"),m=s("7xgn"),g=s("QaEg"),b=s("oFXy"),f=s("lHET");function S(){u.call(this,b.ServerModuleName),this.enable=o.observable(!1),this.keepcopy=o.observable(!0),this.email=o.observable(""),this.email.focused=o.observable(!1),m.editedId.subscribe((function(){this.bShown&&this.populate()}),this)}i.extendOwn(S.prototype,u.prototype),S.prototype.ViewTemplate="MailWebclient_Settings_AccountForwardSettingsFormView",S.prototype.getCurrentValues=function(){return[this.enable(),this.keepcopy(),this.email()]},S.prototype.revert=function(){this.populate()},S.prototype.getParametersForSave=function(){return{AccountID:m.getEdited().id(),Enable:this.enable(),Email:n.trim(this.email()),KeepMessageCopy:this.keepcopy()}},S.prototype.applySavedValues=function(e){var t=m.getEdited().forward();t&&(t.enable=e.Enable,t.email=e.Email,t.keepcopy=e.KeepMessageCopy)},S.prototype.save=function(){var e=function(){this.isSaving(!0),this.updateSavedState(),g.send("UpdateForward",this.getParametersForSave(),this.onResponse,this)}.bind(this),t=n.trim(this.email());this.enable()&&""===t?this.email.focused(!0):this.enable()&&""!==t?r.isCorrectEmail(t)?e():d.showPopup(p,[n.i18n("MAILWEBCLIENT/ERROR_INPUT_CORRECT_EMAILS")+" "+t]):e()},S.prototype.onResponse=function(e,t){if(this.isSaving(!1),!1===e.Result)l.showErrorByCode(e,n.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"));else{var s=t.Parameters;this.applySavedValues(s),c.showReport(n.i18n("MAILWEBCLIENT/REPORT_FORWARD_UPDATE_SUCCESS"))}},S.prototype.populate=function(){var e=m.getEdited(),t=e.forward()?e.forward():null;null!==t?(this.enable(t.enable),this.keepcopy(t.keepcopy),this.email(t.email)):g.send("GetForward",{AccountID:e.id()},this.onGetForwardResponse,this),this.updateSavedState()},S.prototype.onGetForwardResponse=function(e,t){if(e&&e.Result){var s=t.Parameters,i=a.pInt(s.AccountID),o=m.getAccount(i),r=new f;o&&(r.parse(i,e.Result),o.forward(r),i===m.editedId()&&this.populate())}},e.exports=new S},"0mCI":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("/QeJ"),h=s("TdEd"),c=s("skxT"),u=s("9kOp"),d=h.run("SettingsWebclient","getAbstractSettingsFormViewClass"),p=s("oUN1"),m=h.run("ChangePasswordWebclient","getChangePasswordPopup"),g=s("7xgn"),b=s("QaEg"),f=s("oFXy"),S=s("Z8ia");function E(){d.call(this,f.ServerModuleName),this.sFakePass="xxxxxxxx",this.bAllowIdentities=f.AllowIdentities,this.useToAuthorize=r.observable(!1),this.canBeUsedToAuthorize=r.observable(!1),this.isDefaultAccount=r.observable(!1),this.isServerOwner=r.observable(!1),this.friendlyName=r.observable(""),this.email=r.observable(""),this.incomingLogin=r.observable(""),this.incomingPassword=r.observable(""),this.allowSpecifyPassword=r.observable(!1),this.useThreading=r.observable(!1),this.saveRepliesToCurrFolder=r.observable(!1),this.oServerPairPropertiesView=new S("acc_edit"),this.enableThreading=this.oServerPairPropertiesView.enableThreading,this.enableThreading.subscribe((function(){this.enableThreading()||this.useThreading(!1)}),this),this.allowChangePassword=r.observable(!1),this.incLoginFocused=r.observable(!1),this.incLoginFocused.subscribe((function(){this.incLoginFocused()&&""===this.incomingLogin()&&this.incomingLogin(this.email())}),this),g.editedId.subscribe((function(){this.bShown&&this.populate()}),this),this.updateSavedState(),this.oServerPairPropertiesView.currentValues.subscribe((function(){this.updateSavedState()}),this),this.visibleTab=r.observable(!0),r.computed((function(){var e=g.getEdited();e?(this.allowChangePassword(h.run("ChangePasswordWebclient","isChangePasswordButtonAllowed",[g.collection().length,e])),this.isDefaultAccount(e.bDefault),this.isServerOwner(e.oServer.sOwnerType===Enums.ServerOwnerType.Account)):(this.allowChangePassword(!1),this.isDefaultAccount(!1))}),this),this.isDisableAuthorize=r.observable(u.userAccountsCount()<=1),this.oDefaultAccountHostsSettingsView=s("fSBA")}i.extendOwn(E.prototype,d.prototype),E.prototype.ViewTemplate="MailWebclient_Settings_AccountSettingsFormView",E.prototype.onShow=function(){this.oServerPairPropertiesView.fullInit(),this.populate()},E.prototype.getCurrentValues=function(){var e=[this.useToAuthorize(),this.friendlyName(),this.email(),this.incomingLogin(),this.incomingPassword(),this.useThreading(),this.saveRepliesToCurrFolder()],t=this.oServerPairPropertiesView.currentValues();return e.concat(t)},E.prototype.getParametersForSave=function(){var e=g.getEdited(),t=o.trim(this.incomingPassword());return{AccountID:e.id(),UseToAuthorize:this.useToAuthorize(),FriendlyName:this.friendlyName(),Email:o.trim(this.email()),IncomingLogin:o.trim(this.incomingLogin()),IncomingPassword:t===this.sFakePass?"":t,Server:this.oServerPairPropertiesView.getParametersForSave(),UseThreading:this.useThreading(),SaveRepliesToCurrFolder:this.saveRepliesToCurrFolder()}},E.prototype.revert=function(){this.populate()},E.prototype.populate=function(){var e=g.getEdited();this.passwordMightBeIncorrectSubscribtion&&(this.passwordMightBeIncorrectSubscribtion.dispose(),this.passwordMightBeIncorrectSubscribtion=null),e?(this.friendlyName(e.friendlyName()),this.email(e.email()),this.incomingLogin(e.incomingLogin()),this.incomingPassword(this.sFakePass),this.allowSpecifyPassword(e.passwordMightBeIncorrect()),e.passwordMightBeIncorrect()||(this.passwordMightBeIncorrectSubscribtion=e.passwordMightBeIncorrect.subscribe(function(){this.allowSpecifyPassword(e.passwordMightBeIncorrect()),this.passwordMightBeIncorrectSubscribtion.dispose(),this.passwordMightBeIncorrectSubscribtion=null}.bind(this))),this.oServerPairPropertiesView.setServer(e.oServer),this.useToAuthorize(e.useToAuthorize()),this.canBeUsedToAuthorize(e.canBeUsedToAuthorize()),this.useThreading(e.useThreading()),this.saveRepliesToCurrFolder(e.bSaveRepliesToCurrFolder),this.isDisableAuthorize(!!this.useToAuthorize()&&u.userAccountsCount()<=1)):(this.friendlyName(""),this.email(""),this.incomingLogin(""),this.incomingPassword(""),this.allowSpecifyPassword(!1),this.oServerPairPropertiesView.clear(),this.useToAuthorize(!0),this.canBeUsedToAuthorize(!1),this.useThreading(!1),this.isDisableAuthorize(!0)),this.updateSavedState()},E.prototype.remove=function(){if(this.isDisableAuthorize())c.showError(n.i18n("COREWEBCLIENT/ERROR_ACCOUNT_DELETING_DISABLE"),!0);else{var e=g.getEdited();e&&e.remove()}},E.prototype.save=function(){this.isSaving(!0),this.updateSavedState(),b.send("UpdateAccount",this.getParametersForSave(),this.onResponse,this)},E.prototype.onResponse=function(e,t){if(this.isSaving(!1),e.Result){var s=t.Parameters,i=a.pInt(s.AccountID),o=g.getAccount(i);o&&(a.isNonEmptyString(s.IncomingPassword)&&s.IncomingPassword!==this.sFakePass&&o.passwordMightBeIncorrect(!1),o.updateFromServer(e.Result),this.populate(),c.showReport(n.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS")))}else l.showErrorByCode(e,n.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},E.prototype.changePassword=function(){this.allowChangePassword()&&p.showPopup(m,[{iAccountId:g.editedId(),sModule:f.ServerModuleName,bHasOldPassword:!0}])},e.exports=new E},uo1V:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("/QeJ"),h=s("TdEd"),c=s("skxT"),u=h.run("SettingsWebclient","getAbstractSettingsFormViewClass"),d=s("7xgn"),p=s("QaEg"),m=s("oFXy");function g(){u.call(this,m.ServerModuleName),this.visibleTab=r.computed((function(){return m.AllowUnifiedInbox&&(m.AllowMultiAccounts&&m.AllowAddAccounts||d.collection().length>1)}),this),this.includeInUnifiedMailbox=r.observable(!1),this.showUnifiedMailboxLabel=r.observable(!1),this.showUnifiedMailboxLabel.subscribe((function(){if(this.showUnifiedMailboxLabel()){if(""===this.unifiedMailboxLabelText()){var e=d.getEdited();this.unifiedMailboxLabelText(e.email())}""===this.unifiedMailboxLabelColor()&&this.unifiedMailboxLabelColor("#f09650")}}),this),this.unifiedMailboxLabelText=r.observable(""),this.unifiedMailboxLabelColor=r.observable(""),d.unifiedMailboxAccounts.subscribe((function(){var e=s("F0Fd"),t=s("Uzkn");e.oUnifiedInbox.hasChanges(!0),e.oUnifiedInbox.removeAllMessageListsFromCacheIfHasChanges(),d.unifiedMailboxAccounts().length>1?e.executeCheckMail():t.hash(t.baseHash())})),this.aColors=["#f09650","#f68987","#6fd0ce","#8fbce2","#b9a4f5","#f68dcf","#d88adc","#4afdb4","#9da1ff","#5cc9c9","#77ca71","#aec9c9"]}i.extendOwn(g.prototype,u.prototype),g.prototype.ViewTemplate="MailWebclient_Settings_AccountUnifiedMailboxFormView",g.prototype.getCurrentValues=function(){return[this.includeInUnifiedMailbox(),this.showUnifiedMailboxLabel(),this.unifiedMailboxLabelText(),this.unifiedMailboxLabelColor()]},g.prototype.getParametersForSave=function(){return{AccountID:d.editedId(),IncludeInUnifiedMailbox:this.includeInUnifiedMailbox(),ShowUnifiedMailboxLabel:this.showUnifiedMailboxLabel(),UnifiedMailboxLabelText:o.trim(this.unifiedMailboxLabelText()),UnifiedMailboxLabelColor:o.trim(this.unifiedMailboxLabelColor())}},g.prototype.revert=function(){this.populate()},g.prototype.populate=function(){var e=d.getEdited();e?(this.includeInUnifiedMailbox(e.includeInUnifiedMailbox()),this.showUnifiedMailboxLabel(e.showUnifiedMailboxLabel()),this.unifiedMailboxLabelText(e.unifiedMailboxLabelText()),this.unifiedMailboxLabelColor(e.unifiedMailboxLabelColor())):(this.includeInUnifiedMailbox(!1),this.showUnifiedMailboxLabel(!1),this.unifiedMailboxLabelText(""),this.unifiedMailboxLabelColor("")),this.updateSavedState()},g.prototype.save=function(){this.isSaving(!0),this.updateSavedState(),p.send("UpdateAccountUnifiedMailbox",this.getParametersForSave(),this.onResponse,this)},g.prototype.onResponse=function(e,t){if(this.isSaving(!1),e.Result){var s=t.Parameters,i=a.pInt(s.AccountID),o=d.getAccount(i);o&&(o.updateFromServer(e.Result),this.populate(),c.showReport(n.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS")))}else l.showErrorByCode(e,n.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},g.prototype.setColor=function(e){this.unifiedMailboxLabelColor(e)},e.exports=new g},r9cz:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("9kOp"),a=s("TdEd"),l=s("W66n"),h=s("skxT"),c=s("oUN1"),u=s("/nhf"),d=s("exVY"),p=s("hXOA"),m=s("KmL1"),g=s("QaEg"),b=s("7xgn"),f=s("Oh7n"),S=s("oFXy"),E=s("JTYw"),A=s("exJb"),v=s("4Jr3"),y=s("DXx+"),I=s("dFFs"),F=s("0mCI"),C=s("uo1V"),M=s("ZS9T"),T=s("63Nt"),L=s("j60I"),w=s("6U3T"),R=s("N2aM");function x(){this.bAllowAddAccounts=S.AllowAddAccounts,this.bAllowMultiAccounts=S.AllowMultiAccounts,this.bAllowIdentities=!!S.AllowIdentities,this.bAllowFetchers=!!S.AllowFetchers,this.bAllowAliases=!!S.AllowAliases,this.accounts=b.collection,this.editedAccountId=b.editedId,this.editedFetcher=o.observable(null),this.editedFetcherId=o.computed((function(){return this.editedFetcher()?this.editedFetcher().id():null}),this),this.editedIdentity=o.observable(null),this.editedIdentityHash=o.computed((function(){return this.editedIdentity()?this.editedIdentity().hash():null}),this),this.editedAlias=o.observable(null),this.editedAliasId=o.computed((function(){return this.editedAlias()?this.editedAlias().id():null}),this),this.allowFolders=o.observable(!1),this.allowForward=o.observable(!1),this.allowAutoresponder=o.observable(!1),this.allowFilters=o.observable(!1),this.allowSignature=o.observable(!1),this.visibleAllowBlockLists=o.observable(!1),this.aAccountTabs=[{name:"properties",title:r.i18n("MAILWEBCLIENT/LABEL_PROPERTIES_TAB"),view:F,visible:F.visibleTab},{name:"unified",title:r.i18n("MAILWEBCLIENT/LABEL_UNIFIED_MAILBOX_TAB"),view:C,visible:C.visibleTab},{name:"folders",title:r.i18n("MAILWEBCLIENT/LABEL_MANAGE_FOLDERS_TAB"),view:y,visible:this.allowFolders},{name:"forward",title:r.i18n("MAILWEBCLIENT/LABEL_FORWARD_TAB"),view:I,visible:this.allowForward},{name:"autoresponder",title:r.i18n("MAILWEBCLIENT/LABEL_AUTORESPONDER_TAB"),view:E,visible:this.allowAutoresponder},{name:"filters",title:r.i18n("MAILWEBCLIENT/LABEL_FILTERS_TAB"),view:v,visible:this.allowFilters},{name:"signature",title:r.i18n("MAILWEBCLIENT/LABEL_SIGNATURE_TAB"),view:R,visible:this.allowSignature},{name:"allow-block-lists",title:r.i18n("MAILWEBCLIENT/LABEL_ACCOUNT_SPAM_TAB"),view:A,visible:this.visibleAllowBlockLists}],this.aIdentityTabs=[{name:"properties",title:r.i18n("MAILWEBCLIENT/LABEL_PROPERTIES_TAB"),view:new M(this),visible:o.observable(!0)},{name:"signature",title:r.i18n("MAILWEBCLIENT/LABEL_SIGNATURE_TAB"),view:R,visible:o.observable(!0)}],this.aFetcherTabs=[{name:"incoming",title:r.i18n("MAILWEBCLIENT/LABEL_POP3_SETTINGS_TAB"),view:new T(this),visible:o.observable(!0)},{name:"outgoing",title:r.i18n("MAILWEBCLIENT/LABEL_SMTP_SETTINGS_TAB"),view:w,visible:o.observable(!0)},{name:"signature",title:r.i18n("MAILWEBCLIENT/LABEL_SIGNATURE_TAB"),view:R,visible:o.observable(!0)}],this.aAliasTabs=[{name:"properties",title:r.i18n("MAILWEBCLIENT/LABEL_PROPERTIES_TAB"),view:new L(this,this.bAllowAliases),visible:o.observable(!0)},{name:"signature",title:r.i18n("MAILWEBCLIENT/LABEL_SIGNATURE_TAB"),view:R,visible:o.observable(!0)}],this.currentTab=o.observable(null),this.tabs=o.computed((function(){return this.editedIdentity()?this.aIdentityTabs:this.editedFetcher()?this.aFetcherTabs:this.editedAlias()?this.aAliasTabs:this.aAccountTabs}),this),b.editedId.subscribe((function(){this.populate()}),this),n.broadcastEvent("MailWebclient::ConstructView::after",{Name:this.ViewConstructorName,View:this})}x.prototype.ViewTemplate="MailWebclient_Settings_AccountsSettingsPaneView",x.prototype.ViewConstructorName="CAccountsSettingsPaneView",x.prototype.hasUnsavedChanges=function(){var e=this.currentTab();return e&&e.view&&i.isFunction(e.view.hasUnsavedChanges)&&e.view.hasUnsavedChanges()},x.prototype.revert=function(){var e=this.currentTab();e&&e.view&&i.isFunction(e.view.revert)&&e.view.revert()},x.prototype.hide=function(e,t){this.currentTab()&&i.isFunction(this.currentTab().view.hide)?this.currentTab().view.hide(e,t):e()},x.prototype.showTab=function(e){var t=e.length>0?e[0]:"account",s=b.getEdited(),o=e.length>1?e[1]:s?s.hash():"",n=e.length>2?e[2]:"";this.editedIdentity("identity"===t&&b.getIdentityByHash(o)||null),this.editedFetcher("fetcher"===t&&b.getFetcherByHash(o)||null),this.editedAlias("alias"===t&&b.getAliasByHash(o)||null),"account"===t&&("create"!==e[1]||b.hasAccount()?""!==o&&(s&&s.hash()===o?this.populate():i.find(b.collection(),(function(e){return e.hash()===o}))?b.changeEditedAccountByHash(o):l.replaceHash(["settings","mail-accounts"])):(this.addAccount(),h.showError(r.i18n("MAILWEBCLIENT/INFO_SPECIFY_CREDENTIALS")),l.replaceHashDirectly(["settings","mail-accounts"]))),this.changeTab(n||this.getAutoselectedTab().name)},x.prototype.getAutoselectedTab=function(){var e=i.find(this.tabs(),(function(e){return e.visible()}));return e||(e=this.tabs()[0]),e},x.prototype.addAccount=function(){var e=i.isFunction(n.getTenantId)?n.getTenantId():null;null!==e?g.send("GetServers",{TenantId:e},(function(e){var t=[];i.isArray(e&&e.Result&&e.Result.Items)&&(i.each(e.Result.Items,(function(e){var s=new f(e);s.bOauthEnable&&t.push({Name:s.sOauthName,Type:s.sOauthType,IconUrl:s.sOauthIconUrl})})),t.length>0&&t.push({Name:"Other",Type:"",IconUrl:"static/styles/images/modules/MailWebclient/logo_other.png"})),this.openCreateAccountShortFormPopup(t)}),this):this.openCreateAccountShortFormPopup([])},x.prototype.openCreateAccountShortFormPopup=function(e){c.showPopup(u,[e,i.bind((function(e){var t=b.getAccount(e);t&&this.editAccount(t.hash())}),this)])},x.prototype.editAccount=function(e){a.run("SettingsWebclient","setAddHash",[["account",e]])},x.prototype.addIdentity=function(e,t){t.stopPropagation(),c.showPopup(d,[e])},x.prototype.editIdentity=function(e){a.run("SettingsWebclient","setAddHash",[["identity",e]])},x.prototype.addFetcher=function(e,t){t.stopPropagation(),c.showPopup(p,[e])},x.prototype.editFetcher=function(e){a.run("SettingsWebclient","setAddHash",[["fetcher",e]])},x.prototype.addAlias=function(e,t){t.stopPropagation(),c.showPopup(m,[e])},x.prototype.editAlias=function(e){a.run("SettingsWebclient","setAddHash",[["alias",e]])},x.prototype.changeRoute=function(e){var t=b.getEdited(),s=["account",t?t.hash():"",e];this.editedIdentity()?s=["identity",this.editedIdentity().hash(),e]:this.editedFetcher()?s=["fetcher",this.editedFetcher().hash(),e]:this.editedAlias()&&(s=["alias",this.editedAlias().hash(),e]),a.run("SettingsWebclient","setAddHash",[s])},x.prototype.changeTab=function(e){var t=this.currentTab(),s=i.find(this.tabs(),(function(t){return t.visible()&&t.name===e})),o=function(){s&&(i.isFunction(s.view.showTab)&&s.view.showTab(this.editedIdentity()||this.editedFetcher()||this.editedAlias()),this.currentTab(s))}.bind(this),r=!0;s?t&&i.isFunction(t.view.hide)&&(t.view.hide(o,i.bind((function(){i.isFunction(l.stopListening)&&i.isFunction(l.startListening)&&l.stopListening(),this.changeRoute(t.name),i.isFunction(l.startListening)&&l.startListening()}),this)),r=!1):t||(s=this.getAutoselectedTab()),t||i.delay(i.bind((function(){this.changeRoute(s.name)}),this)),r&&o()},x.prototype.populate=function(){var e=b.getEdited();e&&(this.allowFolders(e.allowManageFolders()),this.allowForward(e.allowForward()),this.allowAutoresponder(e.allowAutoresponder()),this.allowFilters(e.allowFilters()),this.allowSignature(!S.AllowIdentities),this.visibleAllowBlockLists(e.enableAllowBlockLists()),this.currentTab()&&this.currentTab().visible()||this.currentTab(this.getAutoselectedTab()))},x.prototype.onRemoveIdentity=function(){this.editedIdentity(null),this.changeTab(this.currentTab()?this.currentTab().name:"")},x.prototype.onRemoveFetcher=function(){this.editedFetcher(null),this.changeRoute("")},x.prototype.onRemoveAlias=function(){this.editedAlias(null),this.changeRoute("")},e.exports=new x},j60I:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("/QeJ"),a=s("TdEd"),l=s("skxT"),h=a.run("SettingsWebclient","getAbstractSettingsFormViewClass"),c=s("7xgn"),u=s("EFhx"),d=s("oFXy"),p=s("oUN1"),m=s("XeMN");function g(e,t){h.call(this,d.ServerModuleName),this.alias=o.observable(null),this.oParent=e,this.disableRemoveAlias=o.observable(!t),this.friendlyName=o.observable(""),this.friendlyNameHasFocus=o.observable(!1)}i.extendOwn(g.prototype,h.prototype),g.prototype.ViewTemplate="MailWebclient_Settings_AliasSettingsFormView",g.prototype.ViewConstructorName="CAliasSettingsFormView",g.prototype.onShow=function(e){this.alias(e&&e.ALIAS?e:null),this.populate()},g.prototype.getCurrentValues=function(){return[this.friendlyName()]},g.prototype.getParametersForSave=function(){return this.alias()?{AccountID:this.alias().accountId(),FriendlyName:this.friendlyName(),EntityId:this.alias().id()}:{}},g.prototype.save=function(){this.isSaving(!0),this.updateSavedState(),u.send(d.AliasesServerModuleName,"UpdateAlias",this.getParametersForSave(),this.onResponse,this)},g.prototype.onResponse=function(e,t){this.isSaving(!1),e.Result?(c.populateAliases((function(){var t=c.getCurrent().aliases(),s=i.find(t,(function(t){return t.id()===e.Result}));s&&a.run("SettingsWebclient","setAddHash",[["alias",s.hash()]])})),l.showReport(r.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))):n.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_ALIAS_ADDING"))},g.prototype.populate=function(){var e=this.alias();e&&(this.friendlyName(e.friendlyName()),setTimeout(function(){this.updateSavedState()}.bind(this),1))},g.prototype.remove=function(){this.alias()&&p.showPopup(m,[r.i18n("MAILWEBCLIENT/CONFIRM_DELETE_ALIAS"),i.bind((function(e){if(e){var t={AccountID:this.alias().accountId(),Aliases:[this.alias().email()]};u.send(d.AliasesServerModuleName,"DeleteAliases",t,this.onAccountAliasDeleteResponse,this),i.isFunction(this.oParent.onRemoveAlias)&&this.oParent.onRemoveAlias()}}),this)])},g.prototype.onAccountAliasDeleteResponse=function(e,t){e.Result||n.showErrorByCode(e,r.i18n("MAILWEBCLIENT/ERROR_ALIAS_DELETING")),c.populateAliases()},g.prototype.cancel=function(){i.isFunction(this.oParent.cancelPopup)&&this.oParent.cancelPopup()},e.exports=g},"63Nt":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("REt5"),l=s("/QeJ"),h=s("TdEd"),c=s("skxT"),u=s("EFhx"),d=s("oUN1"),p=s("XeMN"),m=h.run("SettingsWebclient","getAbstractSettingsFormViewClass"),g=s("7xgn"),b=s("F0Fd"),f=s("oFXy"),S=s("DBk0");function E(e){m.call(this,f.ServerModuleName),this.oParent=e,this.bShown=!1,this.fetcher=r.observable(null),this.idFetcher=r.observable(null),this.isEnabled=r.observable(!0),this.incomingLogin=r.observable(""),this.sFakePass="******",this.incomingPassword=r.observable(this.sFakePass),this.oIncoming=new S(110,995,"fetcher_edit_incoming",n.i18n("MAILWEBCLIENT/LABEL_POP3_SERVER")),this.sFetcherFolder="",this.folder=r.observable(""),this.options=r.observableArray([]),b.folderList.subscribe((function(){this.populateOptions()}),this),this.leaveMessagesOnServer=r.observable(!1),this.passwordIsSelected=r.observable(!1),this.defaultOptionsAfterRender=a.defaultOptionsAfterRender,this.fetcherIntervalHint=r.computed((function(){var e=this.fetcher()?this.fetcher().iCheckIntervalMinutes:0;return 0!==e?n.i18n("MAILWEBCLIENT/INFO_POP3_FETCHER_PLURAL",{INTERVAL:e},null,e):""}),this)}i.extendOwn(E.prototype,m.prototype),E.prototype.ViewTemplate="MailWebclient_Settings_FetcherIncomingSettingsFormView",E.prototype.onShow=function(e){this.fetcher(e&&e.FETCHER?e:null),this.populateOptions(),this.populate()},E.prototype.hide=function(e){this.bShown=!1,e()},E.prototype.populateOptions=function(){this.bShown&&(this.options(b.folderList().getOptions("",!0,!1,!1)),this.sFetcherFolder!==this.folder()&&(this.folder(this.sFetcherFolder),this.updateSavedState()))},E.prototype.getCurrentValues=function(){return[this.isEnabled(),this.oIncoming.server(),this.oIncoming.port(),this.oIncoming.ssl(),this.incomingPassword(),this.folder(),this.leaveMessagesOnServer()]},E.prototype.getParametersForSave=function(){if(this.fetcher()){var e=o.trim(this.incomingPassword()),t={FetcherId:this.idFetcher(),IsEnabled:this.isEnabled(),Folder:this.folder(),IncomingServer:this.oIncoming.server(),IncomingPort:this.oIncoming.getIntPort(),IncomingUseSsl:this.oIncoming.ssl(),LeaveMessagesOnServer:this.leaveMessagesOnServer()};return""!==e&&e!==this.sFakePass&&(t.IncomingPassword=e),t}return{}},E.prototype.save=function(){this.isEmptyRequiredFields()?c.showError(n.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY")):(this.isSaving(!0),this.updateSavedState(),u.send(f.FetchersServerModuleName,"UpdateFetcher",this.getParametersForSave(),this.onResponse,this))},E.prototype.onResponse=function(e,t){this.isSaving(!1),e.Result?(g.populateFetchers(),c.showReport(n.i18n("MAILWEBCLIENT/REPORT_SUCCESSFULLY_SAVED"))):l.showErrorByCode(e,n.i18n("COREWEBCLIENT/ERROR_UNKNOWN"))},E.prototype.populate=function(){var e=this.fetcher();e&&(this.sFetcherFolder=e.folder(),this.idFetcher(e.id()),this.isEnabled(e.isEnabled()),this.folder(e.folder()),this.oIncoming.set(e.incomingServer(),e.incomingPort(),e.incomingUseSsl()),this.incomingLogin(e.incomingLogin()),this.incomingPassword(this.sFakePass),this.leaveMessagesOnServer(e.leaveMessagesOnServer()),this.updateSavedState())},E.prototype.isEmptyRequiredFields=function(){return""===this.oIncoming.server()?(this.oIncoming.server.focused(!0),!0):""===o.trim(this.incomingPassword())&&(this.passwordIsSelected(!0),!0)},E.prototype.remove=function(){var e=this.fetcher(),t=function(t){if(t){var s={FetcherId:e.id()};u.send(f.FetchersServerModuleName,"DeleteFetcher",s,this.onAccountDeleteFetcherResponse,this),this.oParent&&i.isFunction(this.oParent.onRemoveFetcher)&&this.oParent.onRemoveFetcher()}}.bind(this);e&&d.showPopup(p,[n.i18n("MAILWEBCLIENT/CONFIRM_REMOVE_FETCHER"),t,e.incomingLogin()])},E.prototype.onAccountDeleteFetcherResponse=function(e,t){e.Result||l.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_FETCHER_DELETING")),g.populateFetchers()},e.exports=E},ZS9T:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("REt5"),h=s("/QeJ"),c=s("TdEd"),u=s("skxT"),d=c.run("SettingsWebclient","getAbstractSettingsFormViewClass"),p=s("7xgn"),m=s("QaEg"),g=s("oFXy");function b(e,t){d.call(this,g.ServerModuleName),this.identity=r.observable(null),this.oParent=e,this.bCreate=t,this.disableCheckbox=r.observable(!1),this.isDefault=r.observable(!1),this.email=r.observable(""),this.emailList=r.observableArray([]),this.selectedEmail=r.observable(""),this.disableEditEmail=r.observable(g.OnlyUserEmailsInIdentities),this.disableRemoveIdentity=r.observable(t),this.friendlyName=r.observable(""),this.friendlyNameHasFocus=r.observable(!1)}i.extendOwn(b.prototype,d.prototype),b.prototype.ViewTemplate="MailWebclient_Settings_IdentitySettingsFormView",b.prototype.ViewConstructorName="CIdentitySettingsFormView",b.prototype.onShow=function(e){this.identity(e&&!e.FETCHER?e:null),this.populate()},b.prototype.getCurrentValues=function(){return[this.friendlyName(),this.email()]},b.prototype.getParametersForSave=function(){if(this.identity()){var e={AccountID:this.identity().accountId(),Default:this.isDefault(),FriendlyName:this.friendlyName(),AccountPart:this.identity().bAccountPart};return this.identity().bAccountPart||(i.extendOwn(e,{Email:this.emailList().length>0?o.trim(this.selectedEmail()):o.trim(this.email())}),this.bCreate||(e.EntityId=this.identity().id())),e}return{}},b.prototype.save=function(){""===o.trim(this.email())?u.showError(l.i18n("MAILWEBCLIENT/ERROR_IDENTITY_FIELDS_BLANK")):(this.isSaving(!0),this.updateSavedState(),m.send(this.bCreate?"CreateIdentity":"UpdateIdentity",this.getParametersForSave(),this.onResponse,this))},b.prototype.onResponse=function(e,t){if(this.isSaving(!1),e.Result){var s=t.Parameters,o=a.pInt(s.AccountID),r=0<o?p.getAccount(o):null;p.populateIdentities((function(){var t=p.getCurrent().identities(),s=i.find(t,(function(t){return t.id()===e.Result}));s&&c.run("SettingsWebclient","setAddHash",[["identity",s.hash()]])})),this.bCreate&&i.isFunction(this.oParent.closePopup)&&this.oParent.closePopup(),s.AccountPart&&r&&r.updateFriendlyName(s.FriendlyName),this.disableCheckbox(this.isDefault()),u.showReport(n.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))}else h.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_IDENTITY_ADDING"))},b.prototype.populate=function(){var e=this.identity();if(e){if(this.isDefault(e.isDefault()),this.email(e.email()),this.disableEditEmail(g.OnlyUserEmailsInIdentities||e.bAccountPart),this.disableRemoveIdentity(this.bCreate||e.bAccountPart),this.emailList([]),g.OnlyUserEmailsInIdentities&&!e.bAccountPart){var t=[],s=p.getAccount(e.accountId());s&&(t=s.aExtend.Aliases),a.isNonEmptyArray(t)&&(this.emailList(i.clone(t)),this.emailList.unshift(e.email()),this.selectedEmail(e.email()))}this.friendlyName(e.friendlyName()),this.disableCheckbox(e.isDefault()),setTimeout(function(){this.updateSavedState()}.bind(this),1)}},b.prototype.remove=function(){if(this.identity()&&!this.identity().bAccountPart){var e={AccountID:this.identity().accountId(),EntityId:this.identity().id()};m.send("DeleteIdentity",e,this.onAccountIdentityDeleteResponse,this),!this.bCreate&&i.isFunction(this.oParent.onRemoveIdentity)&&this.oParent.onRemoveIdentity()}},b.prototype.onAccountIdentityDeleteResponse=function(e,t){e.Result||h.showErrorByCode(e,n.i18n("MAILWEBCLIENT/ERROR_IDENTITY_DELETING")),p.populateIdentities()},b.prototype.cancel=function(){i.isFunction(this.oParent.cancelPopup)&&this.oParent.cancelPopup()},e.exports=b},Z8ia:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("KC/L"),l=s("171C"),h=s("/QeJ"),c=s("9kOp"),u=s("QaEg"),d=s("oFXy"),p=s("Oh7n"),m=s("DBk0");function g(e,t,s){var o={aOauthConnectorsData:[]};c.broadcastEvent("MailWebclient::GetOauthConnectorsData",o),this.bVisibleOauthSettings=t&&a.isNonEmptyArray(o.aOauthConnectorsData),this.aOauthConnectorsData=a.pArray(o.aOauthConnectorsData),this.oauthSelectedConnector=r.observable(""),this.iServersPerPage=a.pInt(s,0),this.totalServersCount=r.observable(0),this.servers=r.observableArray([]),this.serversRetrieved=r.observable(!1),this.serverOptions=r.observableArray([{Name:n.i18n("MAILWEBCLIENT/LABEL_CONFIGURE_SERVER_MANUALLY"),Id:0}]),this.selectedServerId=r.observable(0),this.oLastEditableServer=new p,this.iEditedServerId=0,this.selectedServerId.subscribe((function(){var e=this.selectedServerId(),t=i.find(this.servers(),(function(t){return t.iId===e}));t?(this.oIncoming.isEnabled()&&(this.oLastEditableServer=new p(this.getParametersForSave())),this.setExternalAccessServers(t.bSetExternalAccessServers),this.externalAccessImapServer(t.sExternalAccessImapServer),this.externalAccessImapPort(t.iExternalAccessImapPort),this.externalAccessImapAlterPort(t.iExternalAccessImapAlterPort>0?t.iExternalAccessImapAlterPort:""),this.externalAccessImapUseSsl(t.bExternalAccessImapUseSsl),this.externalAccessPop3Server(t.sExternalAccessPop3Server),this.externalAccessPop3Port(t.iExternalAccessPop3Port),this.externalAccessPop3AlterPort(t.iExternalAccessPop3AlterPort>0?t.iExternalAccessPop3AlterPort:""),this.externalAccessPop3UseSsl(t.bExternalAccessPop3UseSsl),this.externalAccessSmtpServer(t.sExternalAccessSmtpServer),this.externalAccessSmtpPort(t.iExternalAccessSmtpPort),this.externalAccessSmtpAlterPort(t.iExternalAccessSmtpAlterPort>0?t.iExternalAccessSmtpAlterPort:""),this.externalAccessSmtpUseSsl(t.bExternalAccessSmtpUseSsl),this.oauthSelectedConnector(t.bOauthEnable?t.sOauthType:""),this.tenantId(t.iTenantId),this.name(t.sName),this.oIncoming.set(t.sIncomingServer,t.iIncomingPort,t.bIncomingUseSsl),this.oIncoming.isEnabled(this.bAdminEdit),this.oOutgoing.set(t.sOutgoingServer,t.iOutgoingPort,t.bOutgoingUseSsl),this.oOutgoing.isEnabled(this.bAdminEdit),this.outgoingUseAuth(t.sSmtpAuthType===window.Enums.SmtpAuthType.UseUserCredentials),this.outgoingUseAuth.enable(this.bAdminEdit),this.domains(t.sDomains),this.smtpAuthType(t.sSmtpAuthType),this.smtpLogin(t.sSmtpLogin),this.smtpPassword(t.sSmtpPassword),this.enableSieve(t.bEnableSieve),this.sievePort(t.iSievePort),this.enableThreading(t.bEnableThreading),this.useFullEmailAddressAsLogin(t.bUseFullEmailAddressAsLogin)):(this.setExternalAccessServers(this.oLastEditableServer.bSetExternalAccessServers),this.externalAccessImapServer(this.oLastEditableServer.sExternalAccessImapServer),this.externalAccessImapPort(this.oLastEditableServer.iExternalAccessImapPort),this.externalAccessImapAlterPort(this.oLastEditableServer.iExternalAccessImapAlterPort>0?this.oLastEditableServer.iExternalAccessImapAlterPort:""),this.externalAccessImapUseSsl(this.oLastEditableServer.bExternalAccessImapUseSsl),this.externalAccessPop3Server(this.oLastEditableServer.sExternalAccessPop3Server),this.externalAccessPop3Port(this.oLastEditableServer.iExternalAccessPop3Port),this.externalAccessPop3AlterPort(this.oLastEditableServer.iExternalAccessPop3AlterPort>0?this.oLastEditableServer.iExternalAccessPop3AlterPort:""),this.externalAccessPop3UseSsl(this.oLastEditableServer.bExternalAccessPop3UseSsl),this.externalAccessSmtpServer(this.oLastEditableServer.sExternalAccessSmtpServer),this.externalAccessSmtpPort(this.oLastEditableServer.iExternalAccessSmtpPort),this.externalAccessSmtpAlterPort(this.oLastEditableServer.iExternalAccessSmtpAlterPort>0?this.oLastEditableServer.iExternalAccessSmtpAlterPort:""),this.externalAccessSmtpUseSsl(this.oLastEditableServer.bExternalAccessSmtpUseSsl),this.oauthSelectedConnector(this.oLastEditableServer.bOauthEnable?this.oLastEditableServer.sOauthType:""),this.tenantId(0),this.name(this.oLastEditableServer.sName),this.oIncoming.set(this.oLastEditableServer.sIncomingServer,this.oLastEditableServer.iIncomingPort,this.oLastEditableServer.bIncomingUseSsl),this.oIncoming.isEnabled(!0),this.oOutgoing.set(this.oLastEditableServer.sOutgoingServer,this.oLastEditableServer.iOutgoingPort,this.oLastEditableServer.bOutgoingUseSsl),this.oOutgoing.isEnabled(!0),this.outgoingUseAuth(this.oLastEditableServer.sSmtpAuthType===window.Enums.SmtpAuthType.UseUserCredentials),this.outgoingUseAuth.enable(!0),this.domains(""),this.smtpAuthType(window.Enums.SmtpAuthType.UseUserCredentials),this.smtpLogin(""),this.smtpPassword(""),this.enableSieve(!1),this.sievePort(4190),this.enableThreading(!0),this.useFullEmailAddressAsLogin(!0)),this.setCurrentValues()}),this),this.tenantId=r.observable(0),this.name=r.observable(""),this.name.focused=r.observable(!1),this.bAdminEdit=t,this.oIncoming=new m(143,993,e+"_incoming",n.i18n("MAILWEBCLIENT/LABEL_IMAP_SERVER"),null),this.oOutgoing=new m(25,465,e+"_outgoing",n.i18n("MAILWEBCLIENT/LABEL_SMTP_SERVER"),this.oIncoming.server),this.outgoingUseAuth=r.observable(!0),this.outgoingUseAuth.enable=r.observable(!0),this.domains=r.observable(""),this.bAllowEditDomains=d.AllowEditDomainsInServer,this.smtpAuthType=r.observable(window.Enums.SmtpAuthType.UseUserCredentials),this.smtpLogin=r.observable(""),this.smtpPassword=r.observable(""),this.enableSieve=r.observable(!1),this.sievePort=r.observable(4190),this.enableThreading=r.observable(!0),this.useFullEmailAddressAsLogin=r.observable(!0),this.currentValues=r.observable(""),this.aRequiredFields=[this.oIncoming.server,this.oIncoming.port,this.oOutgoing.server,this.oOutgoing.port],t&&this.aRequiredFields.unshift(this.name),this.setExternalAccessServers=r.observable(!1),this.externalAccessImapServer=r.observable(this.oIncoming.server()),this.externalAccessImapPort=r.observable(this.oIncoming.port()),this.externalAccessImapAlterPort=r.observable(""),this.externalAccessImapUseSsl=r.observable(!1),this.externalAccessPop3Server=r.observable(""),this.externalAccessPop3Port=r.observable(110),this.externalAccessPop3AlterPort=r.observable(""),this.externalAccessPop3UseSsl=r.observable(!1),this.externalAccessSmtpServer=r.observable(this.oOutgoing.server()),this.externalAccessSmtpPort=r.observable(this.oOutgoing.port()),this.externalAccessSmtpAlterPort=r.observable(""),this.externalAccessSmtpUseSsl=r.observable(!1),r.computed((function(){this.setExternalAccessServers()||(this.externalAccessImapServer(this.oIncoming.server()),this.externalAccessImapPort(this.oIncoming.port()),this.externalAccessImapAlterPort(""),this.externalAccessImapUseSsl(this.oIncoming.ssl()),this.externalAccessPop3Server(""),this.externalAccessPop3Port(110),this.externalAccessPop3AlterPort(""),this.externalAccessPop3UseSsl(!1),this.externalAccessSmtpServer(this.oOutgoing.server()),this.externalAccessSmtpPort(this.oOutgoing.port()),this.externalAccessSmtpAlterPort(""),this.externalAccessSmtpUseSsl(this.oOutgoing.ssl()))}),this)}g.prototype.ViewTemplate="MailWebclient_Settings_ServerPairPropertiesView",g.prototype.serverInit=function(e){this.setServer(e?new p:this.oLastEditableServer)},g.prototype.fullInit=function(){this.setServer(this.oLastEditableServer),this.serversRetrieved()||this.requestServers()},g.prototype.setServer=function(e){this.oLastEditableServer=e,this.setServerId(e.iId)},g.prototype.setServerId=function(e){if(this.serversRetrieved()||0===e){var t=0===this.selectedServerId();this.selectedServerId(0),this.selectedServerId(e),t&&0===e&&this.selectedServerId.valueHasMutated()}else this.iEditedServerId=e},g.prototype.requestServers=function(e,t){var s=i.isFunction(c.getTenantId)?c.getTenantId():0;this.serversRetrieved(!1),u.send("GetServers",{TenantId:s,Offset:a.pInt(e,0),Limit:this.iServersPerPage,Search:a.pString(t,"")},(function(e){if(i.isArray(e&&e.Result&&e.Result.Items)){var t=[{Name:n.i18n("MAILWEBCLIENT/LABEL_CONFIGURE_SERVER_MANUALLY"),Id:0}];i.each(e.Result.Items,(function(e){t.push({Name:e.Name,Id:a.pInt(e.EntityId)})})),this.servers(i.map(e.Result.Items,(function(e){return new p(e)}))),this.totalServersCount(e.Result.Count),this.serverOptions(t),this.serversRetrieved(!0),this.iEditedServerId&&(this.setServerId(this.iEditedServerId),this.iEditedServerId=0)}else h.showErrorByCode(e)}),this)},g.prototype.clear=function(){this.oIncoming.clear(),this.oOutgoing.clear(),this.outgoingUseAuth(!0)},g.prototype.setCurrentValues=function(){var e=this.bAdminEdit?[this.selectedServerId(),this.name()]:[],t=[this.oIncoming.port(),this.oIncoming.server(),this.oIncoming.ssl(),this.oOutgoing.port(),this.oOutgoing.server(),this.oOutgoing.ssl(),this.outgoingUseAuth(),this.domains(),this.smtpAuthType(),this.smtpLogin(),this.smtpPassword(),this.enableSieve(),this.sievePort(),this.enableThreading(),this.useFullEmailAddressAsLogin(),this.setExternalAccessServers(),this.externalAccessImapServer(),this.externalAccessImapPort(),this.externalAccessImapAlterPort(),this.externalAccessImapUseSsl(),this.externalAccessPop3Server(),this.externalAccessPop3Port(),this.externalAccessPop3AlterPort(),this.externalAccessPop3UseSsl(),this.externalAccessSmtpServer(),this.externalAccessSmtpPort(),this.externalAccessSmtpAlterPort(),this.externalAccessSmtpUseSsl(),this.oauthSelectedConnector()];this.currentValues(e.concat(t).join(":"))},g.prototype.getCurrentValues=function(){return this.setCurrentValues(),[this.currentValues()]},g.prototype.getSmtpAuthType=function(){return this.bAdminEdit||this.smtpAuthType()===window.Enums.SmtpAuthType.UseSpecifiedCredentials?this.smtpAuthType():this.outgoingUseAuth()?window.Enums.SmtpAuthType.UseUserCredentials:window.Enums.SmtpAuthType.NoAuthentication},g.prototype.getParametersForSave=function(){var e=this.selectedServerId(),t=this.oLastEditableServer.iId,s=this.getSmtpAuthType(),r={};0!==e||i.find(this.servers(),(function(e){return t===e.iId}))||(e=t),r={ServerId:e,Name:this.bAdminEdit?this.name():this.oIncoming.server(),IncomingServer:this.oIncoming.server(),IncomingPort:this.oIncoming.getIntPort(),IncomingUseSsl:this.oIncoming.ssl(),OutgoingServer:this.oOutgoing.server(),OutgoingPort:this.oOutgoing.getIntPort(),OutgoingUseSsl:this.oOutgoing.ssl(),Domains:this.domains(),SmtpAuthType:s,SmtpLogin:s===window.Enums.SmtpAuthType.UseSpecifiedCredentials?o.trim(this.smtpLogin()):"",SmtpPassword:s===window.Enums.SmtpAuthType.UseSpecifiedCredentials?o.trim(this.smtpPassword()):"",EnableSieve:this.enableSieve(),SievePort:this.sievePort(),EnableThreading:this.enableThreading(),UseFullEmailAddressAsLogin:this.useFullEmailAddressAsLogin(),SetExternalAccessServers:this.setExternalAccessServers()},this.setExternalAccessServers()&&(r.ExternalAccessImapServer=this.externalAccessImapServer(),r.ExternalAccessImapPort=this.externalAccessImapPort(),r.ExternalAccessImapAlterPort=a.pInt(this.externalAccessImapAlterPort(),0),r.ExternalAccessImapUseSsl=this.externalAccessImapUseSsl(),r.ExternalAccessPop3Server=this.externalAccessPop3Server(),r.ExternalAccessPop3Port=this.externalAccessPop3Port(),r.ExternalAccessPop3AlterPort=a.pInt(this.externalAccessPop3AlterPort(),0),r.ExternalAccessPop3UseSsl=this.externalAccessPop3UseSsl(),r.ExternalAccessSmtpServer=this.externalAccessSmtpServer(),r.ExternalAccessSmtpPort=this.externalAccessSmtpPort(),r.ExternalAccessSmtpAlterPort=a.pInt(this.externalAccessSmtpAlterPort(),0),r.ExternalAccessSmtpUseSsl=this.externalAccessSmtpUseSsl());var n=i.find(this.aOauthConnectorsData,(function(e){return e.Type===this.oauthSelectedConnector()}),this);return r.OAuthEnable=!!n,n&&(r.OAuthName=n.Name,r.OAuthType=n.Type,r.OAuthIconUrl=n.IconUrl),r},g.prototype.validateBeforeSave=function(){return l.checkIfFieldsEmpty(this.aRequiredFields,n.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY"))},g.prototype.onDomainsClick=function(){this.bAllowEditDomains||(o(".tabsbar .item.admin.domain").removeClass("recivedAnim"),setTimeout((function(){o(".tabsbar .item.admin.domain").addClass("recivedAnim")})))},e.exports=g},"6U3T":(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("M4cL"),r=s("p09A"),n=s("H20a"),a=s("/QeJ"),l=s("TdEd"),h=s("skxT"),c=s("EFhx"),u=l.run("SettingsWebclient","getAbstractSettingsFormViewClass"),d=s("7xgn"),p=s("oFXy"),m=s("DBk0");function g(){u.call(this,p.ServerModuleName),this.fetcher=r.observable(null),this.idFetcher=r.observable(null),this.isEnabled=r.observable(!0),this.email=r.observable(""),this.userName=r.observable(""),this.isOutgoingEnabled=r.observable(!1),this.focusEmail=r.observable(!1),this.oOutgoing=new m(25,465,"fetcher_edit_outgoing",n.i18n("MAILWEBCLIENT/LABEL_SMTP_SERVER")),this.outgoingUseAuth=r.observable(!1),this.isAllEnabled=r.computed((function(){return this.isEnabled()&&this.isOutgoingEnabled()}),this),this.isAllEnabled.subscribe((function(){this.oOutgoing.isEnabled(this.isAllEnabled())}),this),this.oOutgoing.isEnabled(this.isAllEnabled()),this.firstState=null}i.extendOwn(g.prototype,u.prototype),g.prototype.ViewTemplate="MailWebclient_Settings_FetcherOutgoingSettingsFormView",g.prototype.onShow=function(e){this.fetcher(e&&e.FETCHER?e:null),this.populate()},g.prototype.getCurrentValues=function(){return[this.isOutgoingEnabled(),this.oOutgoing.server(),this.oOutgoing.port(),this.oOutgoing.ssl(),this.outgoingUseAuth(),this.userName(),this.email()]},g.prototype.getParametersForSave=function(){return this.fetcher()?{FetcherId:this.idFetcher(),IsOutgoingEnabled:this.isOutgoingEnabled(),Email:o.trim(this.email()),Name:this.userName(),OutgoingServer:this.oOutgoing.server(),OutgoingPort:this.oOutgoing.getIntPort(),OutgoingUseSsl:this.oOutgoing.ssl(),OutgoingUseAuth:this.outgoingUseAuth()}:{}},g.prototype.save=function(){this.isEnabled()&&(this.isEmptyRequiredFields()?h.showError(n.i18n("COREWEBCLIENT/ERROR_REQUIRED_FIELDS_EMPTY")):(this.isSaving(!0),this.updateSavedState(),c.send(p.FetchersServerModuleName,"UpdateFetcherSmtpSettings",this.getParametersForSave(),this.onResponse,this)))},g.prototype.onResponse=function(e,t){this.isSaving(!1),e.Result?(d.populateFetchers(),h.showReport(n.i18n("MAILWEBCLIENT/REPORT_SUCCESSFULLY_SAVED"))):a.showErrorByCode(e,n.i18n("COREWEBCLIENT/ERROR_UNKNOWN"))},g.prototype.populate=function(){var e=this.fetcher();e&&(this.fetcher(e),this.idFetcher(e.id()),this.isEnabled(e.isEnabled()),this.email(e.email()),this.userName(e.userName()),this.isOutgoingEnabled(e.isOutgoingEnabled()),this.oOutgoing.set(e.outgoingServer(),e.outgoingPort(),e.outgoingUseSsl()),this.outgoingUseAuth(e.outgoingUseAuth()),this.updateSavedState())},g.prototype.isEmptyRequiredFields=function(){if(this.isOutgoingEnabled()){if(this.outgoingUseAuth()&&this.isOutgoingEnabled()&&""===this.oOutgoing.server())return this.oOutgoing.server.focused(!0),!0;if(this.outgoingUseAuth()&&""===o.trim(this.email()))return this.focusEmail(!0),!0}return!1},e.exports=new g},SpBH:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("KC/L"),a=(s("dfnr"),s("TdEd")),l=s("OfVV"),h=a.run("SettingsWebclient","getAbstractSettingsFormViewClass"),c=s("WOsA"),u=s("oFXy");function d(){h.call(this,u.ServerModuleName),this.bRtl=l.IsRTL,this.bAllowChangeStarredMessagesSource=u.AllowChangeStarredMessagesSource,this.bAllowMailto=u.AllowAppRegisterMailto&&c.isAvailableRegisterMailto(),this.bAllowShowMessagesCountInFolderList=u.AllowShowMessagesCountInFolderList,this.bAllowHorizontalLayout=u.AllowHorizontalLayout,this.mailsPerPageValues=o.observableArray(n.getAdaptedPerPageList(u.MailsPerPage)),this.starredMessagesSourceValues=[{text:r.i18n("MAILWEBCLIENT/LABEL_STARRED_MESSAGES_SOURCE_INBOX"),value:Enums.StarredMessagesSource.InboxOnly},{text:r.i18n("MAILWEBCLIENT/LABEL_STARRED_MESSAGES_SOURCE_ALL_FOLDERS"),value:Enums.StarredMessagesSource.AllFolders}],this.aLayoutValues=[{text:r.i18n("MAILWEBCLIENT/LABEL_VERT_SPLIT_LAYOUT"),value:!1},{text:r.i18n("MAILWEBCLIENT/LABEL_HORIZ_SPLIT_LAYOUT"),value:!0}],this.mailsPerPage=o.observable(u.MailsPerPage),this.starredMessagesSource=o.observable(u.StarredMessagesSource),this.allowAutosaveInDrafts=o.observable(u.AllowAutosaveInDrafts),this.allowChangeInputDirection=o.observable(u.AllowChangeInputDirection),this.showMessagesCountInFolderList=o.observable(u.showMessagesCountInFolderList()),this.horizontalLayout=o.observable(u.HorizontalLayout)}i.extendOwn(d.prototype,h.prototype),d.prototype.ViewTemplate="MailWebclient_Settings_MailSettingsFormView",d.prototype.registerMailto=function(){c.registerMailto()},d.prototype.getCurrentValues=function(){return[this.mailsPerPage(),this.allowAutosaveInDrafts(),this.allowChangeInputDirection(),this.showMessagesCountInFolderList(),this.horizontalLayout()]},d.prototype.revertGlobalValues=function(){this.mailsPerPage(u.MailsPerPage),this.starredMessagesSource(u.StarredMessagesSource),this.allowAutosaveInDrafts(u.AllowAutosaveInDrafts),this.allowChangeInputDirection(u.AllowChangeInputDirection),this.showMessagesCountInFolderList(u.showMessagesCountInFolderList()),this.horizontalLayout(u.HorizontalLayout)},d.prototype.getParametersForSave=function(){return{MailsPerPage:this.mailsPerPage(),StarredMessagesSource:this.starredMessagesSource(),AllowAutosaveInDrafts:this.allowAutosaveInDrafts(),AllowChangeInputDirection:this.allowChangeInputDirection(),ShowMessagesCountInFolderList:this.showMessagesCountInFolderList(),HorizontalLayout:this.horizontalLayout()}},d.prototype.applySavedValues=function(e){e.HorizontalLayout!==u.HorizontalLayout&&window.location.reload(),u.update(e)},d.prototype.setAccessLevel=function(e,t){this.visible(""===e)},e.exports=new d},N2aM:(e,t,s)=>{"use strict";var i=s("a7T2"),o=s("p09A"),r=s("H20a"),n=s("REt5"),a=s("/QeJ"),l=s("dfnr"),h=s("TdEd"),c=s("skxT"),u=s("EFhx"),d=h.run("SettingsWebclient","getAbstractSettingsFormViewClass"),p=s("kR20"),m=s("7xgn"),g=s("QaEg"),b=s("oFXy"),f=p.getCHtmlEditorView();function S(){d.call(this,b.ServerModuleName),this.fetcherOrIdentity=o.observable(null),this.useSignatureRadio=o.observable(Enums.UseSignature.Off),this.signature=o.observable(""),this.oHtmlEditor=new f(!0,!1),this.oHtmlEditor.textFocused.subscribe((function(){this.oHtmlEditor.textFocused()&&this.useSignatureRadio(Enums.UseSignature.On)}),this),this.enableImageDragNDrop=o.observable(!1),this.allowEditSignature=o.observable(!0),o.computed((function(){this.oHtmlEditor.setInactive(!this.allowEditSignature()||this.useSignatureRadio()===Enums.UseSignature.Off)}),this),this.saveCommand=n.createCommand(this,this.save,this.allowEditSignature)}i.extendOwn(S.prototype,d.prototype),S.prototype.ViewTemplate="MailWebclient_Settings_SignatureSettingsFormView",S.prototype.ViewConstructorName="CSignatureSettingsFormView",S.prototype.onShow=function(e){this.fetcherOrIdentity(e||null),this.populate(),i.defer(i.bind(this.init,this))},S.prototype.init=function(){this.oHtmlEditor.setDisableEdit(!1),this.oHtmlEditor.init(this.signature(),!1,"",r.i18n("MAILWEBCLIENT/LABEL_ENTER_SIGNATURE_HERE")),this.enableImageDragNDrop(this.oHtmlEditor.isDragAndDropSupported()&&!l.ie10AndAbove),this.oHtmlEditor.setDisableEdit(!this.allowEditSignature()),this.updateSavedState()},S.prototype.getCurrentValues=function(){return this.oHtmlEditor.isInitialized()&&this.signature(this.oHtmlEditor.getText()),[this.useSignatureRadio(),this.signature()]},S.prototype.revert=function(){this.populate()},S.prototype.getParametersForSave=function(){this.signature(this.oHtmlEditor.getText());var e=m.getEdited(),t={AccountID:this.fetcherOrIdentity()?this.fetcherOrIdentity().accountId():e?e.id():0,UseSignature:this.useSignatureRadio()===Enums.UseSignature.On,Signature:this.signature()};return this.fetcherOrIdentity()&&(this.fetcherOrIdentity().FETCHER?i.extendOwn(t,{FetcherId:this.fetcherOrIdentity().id()}):this.fetcherOrIdentity().ALIAS?i.extendOwn(t,{AliasId:this.fetcherOrIdentity().id()}):this.fetcherOrIdentity().bAccountPart||i.extendOwn(t,{IdentityId:this.fetcherOrIdentity().id()})),t},S.prototype.applySavedValues=function(e){e.FetcherId?m.populateFetchers():e.AliasId?m.populateAliases():e.IdentityId?m.populateIdentities():e.AccountID&&this.populateAccountSignature(e.AccountID)},S.prototype.populateAccountSignature=function(e){g.send("GetAccount",{AccountId:e},(function(t){if(t.Result){var s=m.getAccount(e);s&&(s.useSignature(!!t.Result.UseSignature),s.signature(t.Result.Signature))}}))},S.prototype.populate=function(){var e=this.fetcherOrIdentity()?this.fetcherOrIdentity().accountId():m.editedId(),t=!!this.fetcherOrIdentity()&&this.fetcherOrIdentity().bAccountPart,s=m.getAccount(e),i=this.fetcherOrIdentity()||s;i&&(this.useSignatureRadio(i.useSignature()?Enums.UseSignature.On:Enums.UseSignature.Off),this.signature(i.signature()),this.oHtmlEditor.setDisableEdit(!1),this.oHtmlEditor.setText(this.signature()),this.allowEditSignature(s&&s.bAllowEditSignature||!t),this.oHtmlEditor.setDisableEdit(!this.allowEditSignature())),this.updateSavedState()},S.prototype.save=function(){this.isSaving(!0),this.updateSavedState(),this.fetcherOrIdentity()&&this.fetcherOrIdentity().FETCHER?u.send(b.FetchersServerModuleName,"UpdateSignature",this.getParametersForSave(),this.onResponse,this):this.fetcherOrIdentity()&&this.fetcherOrIdentity().ALIAS?u.send(b.AliasesServerModuleName,"UpdateSignature",this.getParametersForSave(),this.onResponse,this):g.send("UpdateSignature",this.getParametersForSave(),this.onResponse,this)},S.prototype.onResponse=function(e,t){this.isSaving(!1),e.Result?(this.applySavedValues(t.Parameters),c.showReport(r.i18n("COREWEBCLIENT/REPORT_SETTINGS_UPDATE_SUCCESS"))):a.showErrorByCode(e,r.i18n("COREWEBCLIENT/ERROR_SAVING_SETTINGS_FAILED"))},e.exports=new S}}]);